(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{1212:function(e,t,l){Promise.resolve().then(l.bind(l,8816))},8816:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return g}});var i=l(7437),n=l(2265),a=l(4310),r=l(1459);let d="tastingpos_layout_v6",o={x:22,y:22},s=()=>Math.random().toString(36).slice(2)+"_"+Date.now().toString(16),c=[{id:"rest",label:"RESTAURANTE"},{id:"terr",label:"TERRAZA"},{id:"vip",label:"ZONA VIP"}];function x(e,t,l){return Math.max(t,Math.min(l,e))}function u(e){return 20*Math.round(e/20)}function b(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}function m(e,t){return e.pageId||t}function v(e){let t=e.obj||e.shape||"TABLE_SQUARE";return"SQUARE"===t?"TABLE_SQUARE":"ROUND"===t?"TABLE_ROUND":"RECT"===t?"TABLE_RECT":"UMBRELLA"===t||"BAR_SEATS"===t||"TERRACE"===t||"BAR"===t?"TABLE_SQUARE":t||"TABLE_SQUARE"}function h(e){return{w:Number.isFinite(e.w)?e.w:92,h:Number.isFinite(e.h)?e.h:92}}let p=["from-amber-500/8 to-amber-500/0","from-emerald-500/10 to-emerald-500/0","from-fuchsia-500/10 to-fuchsia-500/0"];function g(){var e,t,l,g,A,T,R,C;let{t:S}=(0,r.Q)(),{tables:_,setTables:I}=(0,a.mr)(),P=n.useRef(null),[L,B]=n.useState(c),[M,O]=n.useState(null!==(A=null===(e=c[0])||void 0===e?void 0:e.id)&&void 0!==A?A:"rest"),[U,D]=n.useState("select"),[Z,X]=n.useState(()=>Object.fromEntries(c.map(e=>[e.id,{x:o.x,y:o.y,w:900,h:756}]))),[G,Q]=n.useState([]),[W,Y]=n.useState([]),[F,J]=n.useState(null),[V,H]=n.useState(null),[q,K]=n.useState(null);n.useEffect(()=>{if(!V)return;let e=setTimeout(()=>H(null),1300);return()=>clearTimeout(e)},[V]);let $=null!==(T=null===(t=L[0])||void 0===t?void 0:t.id)&&void 0!==T?T:"rest",ee=null!==(R=Z[M])&&void 0!==R?R:{x:o.x,y:o.y,w:900,h:756},et=n.useMemo(()=>({x:0,y:0}),[]),el=n.useCallback((e,t)=>({x:e+et.x,y:t+et.y}),[et.x,et.y]),ei=n.useCallback((e,t)=>({x:e-et.x,y:t-et.y}),[et.x,et.y]),en=n.useCallback(()=>{let e={version:6,pages:L,pageRects:Z,zones:G,walls:W,tables:Object.fromEntries(_.map(e=>[e.id,{x:e.x,y:e.y,w:h(e).w,h:h(e).h,pageId:m(e,$),obj:v(e),name:e.name}]))};localStorage.setItem(d,JSON.stringify(e)),H(S("Saved","Saved"))},[$,Z,L,G,W,_]);n.useEffect(()=>{var e,t,l,i,n,a,r,s,x,u,m,v,h,p,g,f,w,y,N,j,k,E,z,A,T,R,C,S,_,P;let L=null!==(i=b(localStorage.getItem(d)))&&void 0!==i?i:b(localStorage.getItem("tastingpos_layout_v5"));if(!L)return;let M={RESTAURANTE:"rest",TERRAZA:"terr",VIP:"vip"},U=c,D=Object.fromEntries(c.map(e=>[e.id,{x:o.x,y:o.y,w:900,h:756}])),Z=null===(e=c[0])||void 0===e?void 0:e.id,G=[],W=[],F={};if(L.version>=6&&Array.isArray(L.pages))U=L.pages,D=null!==(r=L.pageRects)&&void 0!==r?r:D,Z=null!==(s=null===(n=L.pages[0])||void 0===n?void 0:n.id)&&void 0!==s?s:null===(a=c[0])||void 0===a?void 0:a.id,G=Array.isArray(L.zones)?L.zones:[],W=Array.isArray(L.walls)?L.walls:[],F=null!==(x=L.tables)&&void 0!==x?x:{};else{if(!L.mains&&!L.mainLabels)return;let e=null!==(z=L.mainLabels)&&void 0!==z?z:{};U=[{id:"rest",label:e.RESTAURANTE||"RESTAURANTE"},{id:"terr",label:e.TERRAZA||"TERRAZA"},{id:"vip",label:e.VIP||"ZONA VIP"}],D={rest:{x:null!==(A=null===(m=L.mains)||void 0===m?void 0:null===(u=m.RESTAURANTE)||void 0===u?void 0:u.x)&&void 0!==A?A:o.x,y:null!==(T=null===(h=L.mains)||void 0===h?void 0:null===(v=h.RESTAURANTE)||void 0===v?void 0:v.y)&&void 0!==T?T:o.y,w:900,h:756},terr:{x:null!==(R=null===(g=L.mains)||void 0===g?void 0:null===(p=g.TERRAZA)||void 0===p?void 0:p.x)&&void 0!==R?R:o.x,y:null!==(C=null===(w=L.mains)||void 0===w?void 0:null===(f=w.TERRAZA)||void 0===f?void 0:f.y)&&void 0!==C?C:o.y,w:900,h:756},vip:{x:null!==(S=null===(N=L.mains)||void 0===N?void 0:null===(y=N.VIP)||void 0===y?void 0:y.x)&&void 0!==S?S:o.x,y:null!==(_=null===(k=L.mains)||void 0===k?void 0:null===(j=k.VIP)||void 0===j?void 0:j.y)&&void 0!==_?_:o.y,w:900,h:756}},Z=null===(E=U[0])||void 0===E?void 0:E.id,G=Array.isArray(L.zones)?L.zones.map(e=>{var t,l;return{...e,pageId:null!==(l=M[e.main])&&void 0!==l?l:null===(t=U[0])||void 0===t?void 0:t.id}}):[],W=Array.isArray(L.walls)?L.walls.map(e=>{var t,l;return{...e,pageId:null!==(l=M[e.main])&&void 0!==l?l:null===(t=U[0])||void 0===t?void 0:t.id}}):[],L.tables&&(F=Object.fromEntries(Object.entries(L.tables).map(e=>{var t,l,i,n;let[a,r]=e;return[Number(a),{x:r.x,y:r.y,w:r.w,h:r.h,pageId:null!==(l=M[r.main])&&void 0!==l?l:null===(t=U[0])||void 0===t?void 0:t.id,obj:null!==(n=null!==(i=r.obj)&&void 0!==i?i:r.shape)&&void 0!==n?n:"TABLE_SQUARE",name:r.name}]})));let t={version:6,pages:U,pageRects:D,zones:G,walls:W,tables:F};localStorage.setItem(d,JSON.stringify(t))}U.forEach(e=>{var t,l;if(!D[e.id]){D[e.id]={x:o.x,y:o.y,w:900,h:756};return}let i=D[e.id];D[e.id]={x:null!==(t=i.x)&&void 0!==t?t:o.x,y:null!==(l=i.y)&&void 0!==l?l:o.y,w:900,h:756}}),B(U),X(D),O(null!==(P=null!=Z?Z:null===(t=U[0])||void 0===t?void 0:t.id)&&void 0!==P?P:null===(l=c[0])||void 0===l?void 0:l.id),Q(G),Y(W),F&&I(e=>e.map(e=>{var t;let l=F[e.id];return l?{...e,x:l.x,y:l.y,w:l.w,h:l.h,pageId:l.pageId,obj:l.obj,name:null!==(t=l.name)&&void 0!==t?t:e.name}:e}))},[]);let ea=n.useCallback(()=>{let e=localStorage.getItem(d);if(!e)return;let t=new Blob([e],{type:"application/json"}),l=URL.createObjectURL(t),i=document.createElement("a");i.href=l,i.download="tastingpos-layout.json",document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(l)},[]),er=n.useCallback(()=>{let e=window.prompt(S("Paste layout JSON:","Paste layout JSON:"));if(e){if(!b(e)){H(S("Invalid JSON","Invalid JSON"));return}localStorage.setItem(d,e),window.location.reload()}},[]),ed=n.useCallback(()=>{localStorage.removeItem(d),window.location.reload()},[]),eo=n.useMemo(()=>_.filter(e=>m(e,$)===M),[_,M,$]),es=n.useMemo(()=>G.filter(e=>e.pageId===M),[G,M]),ec=n.useMemo(()=>W.filter(e=>e.pageId===M),[W,M]),ex=n.useMemo(()=>[..._].sort((e,t)=>(e.name||"").localeCompare(t.name||"")),[_]),eu=n.useMemo(()=>{var e;return F&&"table"===F.kind&&null!==(e=_.find(e=>e.id===F.id))&&void 0!==e?e:null},[F,_]),eb=n.useMemo(()=>{var e;return F&&"zone"===F.kind&&null!==(e=G.find(e=>e.id===F.id))&&void 0!==e?e:null},[F,G]),em=n.useMemo(()=>{var e;return F&&"wall"===F.kind&&null!==(e=W.find(e=>e.id===F.id))&&void 0!==e?e:null},[F,W]),ev=n.useCallback((e,t,l,i,n)=>{var a;let r=null!==(a=Z[e])&&void 0!==a?a:{x:o.x,y:o.y,w:900,h:756},d=r.x+14,s=r.y+44,c=r.x+r.w-i-14,u=r.y+r.h-n-14;return{x:x(t,d,c),y:x(l,s,u)}},[Z]),eh=(e,t)=>{I(l=>l.map(l=>{var i,n,a,r;if(l.id!==e)return l;let d=null!==(n=null!==(i=t.pageId)&&void 0!==i?i:l.pageId)&&void 0!==n?n:$,o=null!==(a=t.obj)&&void 0!==a?a:v(l),s=Number.isFinite(t.w)?t.w:h(l).w,c=Number.isFinite(t.h)?t.h:h(l).h;if("TABLE_ROUND"===o){let e=Math.max(s,c);s=e,c=e}let x=Number.isFinite(t.x)?t.x:l.x,b=Number.isFinite(t.y)?t.y:l.y,m=ev(d,x=u(x),b=u(b),s,c);return{...l,name:null!==(r=t.name)&&void 0!==r?r:l.name,pageId:d,obj:o,w:s,h:c,x:m.x,y:m.y}}))},ep=(e,t)=>{Q(l=>l.map(l=>{var i;if(l.id!==e)return l;let n={...l,...t},a=null!==(i=Z[n.pageId])&&void 0!==i?i:{x:o.x,y:o.y,w:900,h:756};return n.w=x(n.w,80,a.w-28),n.h=x(n.h,60,a.h-44-14),n.x=x(n.x,a.x+14,a.x+a.w-n.w-14),n.y=x(n.y,a.y+44,a.y+a.h-n.h-14),n}))},eg=(e,t)=>{Y(l=>l.map(l=>{var i;if(l.id!==e)return l;let n={...l,...t},a=null!==(i=Z[n.pageId])&&void 0!==i?i:{x:o.x,y:o.y,w:900,h:756};return n.w=x(n.w,20,a.w-28),n.h=x(n.h,6,a.h-44-14),n.x=x(n.x,a.x+14,a.x+a.w-n.w-14),n.y=x(n.y,a.y+44,a.y+a.h-n.h-14),n}))},ef=(e,t,l,i,n)=>{if(!P.current)return;let a=P.current.getBoundingClientRect(),{x:r,y:d}=el(e.clientX-a.left,e.clientY-a.top);K({pointerId:e.pointerId,kind:t,id:l,offsetX:r-i,offsetY:d-n}),e.currentTarget.setPointerCapture(e.pointerId),e.preventDefault()},ew=(e,t,l,i,n)=>{if(!P.current)return;let a=P.current.getBoundingClientRect(),{x:r,y:d}=el(e.clientX-a.left,e.clientY-a.top);K({pointerId:e.pointerId,kind:t,id:l,offsetX:r,offsetY:d,startW:i,startH:n}),e.currentTarget.setPointerCapture(e.pointerId),e.preventDefault()},ey=e=>{if(q){try{e.currentTarget.releasePointerCapture(q.pointerId)}catch(e){}K(null),en()}},eN=n.useCallback(()=>{I(e=>{var t;let l=e.reduce((e,t)=>Math.max(e,Number(t.id)||0),0)+1,i=null!==(t=Z[M])&&void 0!==t?t:{x:o.x,y:o.y,w:900,h:756},n=u(i.x+14+80),a=u(i.y+44+80);return[...e,{id:l,name:"T".concat(l),pageId:M,obj:"TABLE_SQUARE",w:92,h:92,x:x(n,i.x+14,i.x+i.w-92-14),y:x(a,i.y+44,i.y+i.h-92-14)}]}),H(S("Table added","Table added")),setTimeout(()=>en(),0)},[M,Z,en,I]),ej=n.useCallback(()=>{let e="p_".concat(Date.now().toString(36));B(t=>[...t,{id:e,label:"NEW PAGE"}]),X(t=>({...t,[e]:{x:o.x,y:o.y,w:900,h:756}})),O(e),H(S("Page added","Page added")),setTimeout(()=>en(),0)},[L.length,en]),ek=n.useCallback(e=>{var t,l;if(L.length<=1){H(S("At least one page is required","At least one page is required"));return}let i=L.find(t=>t.id===e),n=(null==i?void 0:i.label)||S("page","page");if(!window.confirm("".concat(S("Delete","Delete")," ").concat(n,"? ").concat(S("Zones/walls will be removed, tables moved.","Zones/walls will be removed, tables moved."))))return;let a=L.filter(t=>t.id!==e),r=null!==(l=null===(t=a[0])||void 0===t?void 0:t.id)&&void 0!==l?l:$;B(a),X(t=>{let l={...t};return delete l[e],l}),Q(t=>t.filter(t=>t.pageId!==e)),Y(t=>t.filter(t=>t.pageId!==e)),I(t=>t.map(t=>m(t,r)===e?{...t,pageId:r}:t)),M===e&&O(r),setTimeout(()=>en(),0)},[M,$,L,en,I,Y,Q]),eE=e=>{if(!eu)return;let t=eu.id;return"S"===e?eh(t,{w:72,h:72}):"M"===e?eh(t,{w:92,h:92}):"L"===e?eh(t,{w:120,h:120}):"RECT"===e?eh(t,{w:190,h:92,obj:"TABLE_RECT"}):eh(t,{w:280,h:120,obj:"TABLE_RECT"})},ez=n.useMemo(()=>new Map(L.map(e=>[e.id,e])),[L]),eA=(null===(l=ez.get(M))||void 0===l?void 0:l.label)||S("PAGE","PAGE"),eT=Math.max(0,L.findIndex(e=>e.id===M));return(0,i.jsxs)("div",{className:"h-full w-full bg-[#0b0b0e] text-white",children:[(0,i.jsx)("div",{className:"px-6 pt-6",children:(0,i.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-gradient-to-b from-zinc-950/80 to-black/50 backdrop-blur-xl shadow-[0_20px_60px_rgba(0,0,0,0.6)] overflow-hidden",children:[(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3 px-4 py-3 border-b border-zinc-800/70",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"h-9 w-9 rounded-xl bg-zinc-900 border border-zinc-800 grid place-items-center",children:(0,i.jsx)("div",{className:"h-2.5 w-2.5 rounded bg-amber-500 shadow-[0_0_20px_rgba(245,158,11,0.6)]"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-lg font-black leading-tight",children:S("Map Builder","Map Builder")}),(0,i.jsx)("div",{className:"text-xs text-zinc-400",children:S("Build map here • During service it’s locked • Offline save","Build map here • During service it’s locked • Offline save")})]})]}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,i.jsx)("button",{onClick:en,className:j,children:S("SAVE","SAVE")}),(0,i.jsx)("button",{onClick:ea,className:N,children:S("EXPORT","EXPORT")}),(0,i.jsx)("button",{onClick:er,className:N,children:S("IMPORT","IMPORT")}),(0,i.jsx)("button",{onClick:ed,className:N,children:S("RESET","RESET")})]})]}),(0,i.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800/70 bg-black/30 flex flex-wrap items-center justify-between gap-3",children:[(0,i.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[L.map(e=>(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("button",{onClick:()=>{O(e.id),J(null),D("select")},className:["px-4 py-2 rounded-xl text-xs font-black border transition",M===e.id?"bg-amber-500 text-black border-amber-400":"bg-zinc-950/40 text-zinc-200 border-zinc-800 hover:bg-zinc-900/40"].join(" "),children:e.label}),(0,i.jsx)("button",{onClick:t=>{t.stopPropagation(),ek(e.id)},className:"h-8 w-8 rounded-xl border border-zinc-800 bg-zinc-950/40 text-zinc-400 hover:text-white hover:border-zinc-700",title:S("Page options","Page options"),children:"⋯"})]},e.id)),(0,i.jsxs)("button",{onClick:ej,className:k,children:["+ ",S("PAGE","PAGE")]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{onClick:()=>D("select"),className:"select"===U?E:k,children:S("SELECT","SELECT")}),(0,i.jsxs)("button",{onClick:eN,className:k,children:["+ ",S("TABLE","TABLE")]}),(0,i.jsxs)("button",{onClick:()=>D("zone"),className:"zone"===U?E:k,children:["+ ",S("ZONE","ZONE")]}),(0,i.jsxs)("button",{onClick:()=>D("wall"),className:"wall"===U?E:k,children:["+ ",S("WALL","WALL")]}),F?(0,i.jsx)("button",{onClick:()=>{F&&("table"===F.kind&&I(e=>e.filter(e=>e.id!==F.id)),"zone"===F.kind&&Q(e=>e.filter(e=>e.id!==F.id)),"wall"===F.kind&&Y(e=>e.filter(e=>e.id!==F.id)),J(null),en())},className:k,children:S("DELETE","DELETE")}):null]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-12 gap-4 p-4",children:[(0,i.jsxs)("div",{className:"col-span-3 rounded-2xl border border-zinc-800 bg-black/30 overflow-hidden",children:[(0,i.jsx)("div",{className:"px-4 py-3 border-b border-zinc-800/70 bg-zinc-950/40",children:(0,i.jsx)("div",{className:"text-xs font-black tracking-widest text-zinc-300",children:S("SETTINGS","SETTINGS")})}),(0,i.jsxs)("div",{className:"p-4 space-y-4",children:[(0,i.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-black/25 p-4",children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500",children:S("PAGE NAME","PAGE NAME")}),(0,i.jsxs)("div",{className:"mt-2 text-sm text-zinc-300",children:[S("Editing:","Editing:")," ",(0,i.jsx)("span",{className:"font-black text-white",children:eA})]}),(0,i.jsx)("input",{className:y+" mt-2",value:(null===(g=ez.get(M))||void 0===g?void 0:g.label)||"",placeholder:S("(optional label)","(optional label)"),onChange:e=>B(t=>t.map(t=>t.id===M?{...t,label:e.target.value.slice(0,18)}:t)),onBlur:en})]}),(0,i.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-black/25 p-4",children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500",children:S("SELECTED","SELECTED")}),eu?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mt-2 text-white font-black",children:eu.name}),(0,i.jsxs)("div",{className:"mt-3",children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500 mb-2",children:S("TABLE NAME / NUMBER","TABLE NAME / NUMBER")}),(0,i.jsx)("input",{value:eu.name,onChange:e=>{let t=e.target.value.slice(0,12);I(e=>e.map(e=>e.id===eu.id?{...e,name:t}:e))},onBlur:en,placeholder:"T12",className:y})]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500 mb-2",children:S("OBJECT","OBJECT")}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,i.jsx)(w,{label:S("SQUARE","SQUARE"),active:"TABLE_SQUARE"===v(eu),onClick:()=>{eh(eu.id,{obj:"TABLE_SQUARE"}),en()}}),(0,i.jsx)(w,{label:S("ROUND","ROUND"),active:"TABLE_ROUND"===v(eu),onClick:()=>{eh(eu.id,{obj:"TABLE_ROUND"}),en()}}),(0,i.jsx)(w,{label:S("RECT","RECT"),active:"TABLE_RECT"===v(eu),onClick:()=>{eh(eu.id,{obj:"TABLE_RECT"}),en()}})]})]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500 mb-2",children:S("SIZE PRESETS","SIZE PRESETS")}),(0,i.jsxs)("div",{className:"grid grid-cols-5 gap-2",children:[(0,i.jsx)("button",{onClick:()=>eE("S"),className:z,children:"S"}),(0,i.jsx)("button",{onClick:()=>eE("M"),className:z,children:"M"}),(0,i.jsx)("button",{onClick:()=>eE("L"),className:z,children:"L"}),(0,i.jsx)("button",{onClick:()=>eE("RECT"),className:z,children:"RECT"}),(0,i.jsx)("button",{onClick:()=>eE("BIG"),className:z,children:"BIG"})]})]}),(0,i.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-2",children:[(0,i.jsx)(f,{label:S("Width","Width"),children:(0,i.jsx)("input",{type:"number",value:h(eu).w,onChange:e=>{let t=x(parseInt(e.target.value||"0",10),60,560);eh(eu.id,{w:t})},onBlur:en,className:y})}),(0,i.jsx)(f,{label:S("Height","Height"),children:(0,i.jsx)("input",{type:"number",value:h(eu).h,onChange:e=>{let t=x(parseInt(e.target.value||"0",10),60,360);eh(eu.id,{h:t})},onBlur:en,className:y})})]}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500 mb-2",children:S("PAGE","PAGE")}),(0,i.jsx)("div",{className:"grid grid-cols-3 gap-2",children:L.map(e=>(0,i.jsx)("button",{onClick:()=>{eh(eu.id,{pageId:e.id}),en()},className:["px-3 py-2 rounded-xl text-[11px] font-black border transition",m(eu,$)===e.id?"bg-amber-500 text-black border-amber-400":"bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900"].join(" "),children:"(p.label || p.id).slice(0, 8)"},e.id))})]})]}):null,eb?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mt-2 text-white font-black",children:S("Zone","Zone")}),(0,i.jsx)("div",{className:"mt-2 text-xs text-zinc-500",children:S("Name optional","Name optional")}),(0,i.jsx)("input",{placeholder:S("(optional label)","(optional label)"),value:null!==(C=eb.label)&&void 0!==C?C:"",onChange:e=>ep(eb.id,{label:e.target.value}),onBlur:en,className:y+" mt-2"})]}):null,em?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mt-2 text-white font-black",children:S("Wall","Wall")}),(0,i.jsx)("div",{className:"mt-2 text-xs text-zinc-500",children:S("Resize with handle","Resize with handle")})]}):null,eu||eb||em?null:(0,i.jsx)("div",{className:"mt-2 text-sm text-zinc-500",children:S("Tap a table / zone / wall.","Tap a table / zone / wall.")})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500 mb-2",children:S("ALL TABLES","ALL TABLES")}),(0,i.jsx)("div",{className:"space-y-2 max-h-[30vh] overflow-auto pr-1",children:ex.map(e=>{var t;let l=(null==F?void 0:F.kind)==="table"&&F.id===e.id;return(0,i.jsxs)("button",{onClick:()=>{J({kind:"table",id:e.id}),O(m(e,$)),D("select")},className:["w-full text-left rounded-2xl border px-3 py-3 transition",l?"border-amber-500/70 bg-amber-500/10":"border-zinc-800 bg-zinc-950/30 hover:bg-zinc-900/30"].join(" "),children:[(0,i.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,i.jsx)("div",{className:"font-black text-white",children:e.name}),(0,i.jsx)("span",{className:"text-[10px] font-black px-2 py-1 rounded-lg border border-zinc-800 bg-black/40 text-zinc-300",children:((null===(t=ez.get(m(e,$)))||void 0===t?void 0:t.label)||m(e,$)).slice(0,10)})]}),(0,i.jsxs)("div",{className:"mt-2 text-xs text-zinc-500 font-mono tabular-nums",children:[v(e)," • ",h(e).w,"\xd7",h(e).h]})]},e.id)})})]})]})]}),(0,i.jsxs)("div",{className:"col-span-9 rounded-2xl border border-zinc-800 bg-black/30 overflow-hidden",children:[(0,i.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800/70 bg-zinc-950/40 flex items-center justify-between",children:[(0,i.jsx)("div",{className:"text-xs font-black tracking-widest text-zinc-300",children:eA}),(0,i.jsx)("div",{className:"text-xs text-zinc-500",children:"".concat(S("Mode","Mode"),": ").concat(U.toUpperCase()," • ").concat(S("Drag","Drag")," • ").concat(S("Resize handle","Resize handle"))})]}),(0,i.jsxs)("div",{ref:P,className:"relative touch-none",style:{height:ee.h+90},onPointerMove:e=>{var t,l,i,n,a,r;if(!q||!P.current)return;let d=P.current.getBoundingClientRect(),{x:s,y:c}=el(e.clientX-d.left,e.clientY-d.top);if("table"===q.kind){I(e=>e.map(e=>{if(e.id!==q.id)return e;let t=m(e,$),l=v(e),{w:i,h:n}=h(e),a=s-q.offsetX,r=c-q.offsetY,d=ev(t,u(a),u(r),i,n);return{...e,x:d.x,y:d.y,obj:l,pageId:t}}));return}if("zone"===q.kind){Q(e=>e.map(e=>{var t;if(e.id!==q.id)return e;let l=null!==(t=Z[e.pageId])&&void 0!==t?t:{x:o.x,y:o.y,w:900,h:756},i=s-q.offsetX,n=c-q.offsetY,a=u(i),r=u(n),d=l.x+14,b=l.y+44,m=l.x+l.w-e.w-14,v=l.y+l.h-e.h-14;return{...e,x:x(a,d,m),y:x(r,b,v)}}));return}if("wall"===q.kind){Y(e=>e.map(e=>{var t;if(e.id!==q.id)return e;let l=null!==(t=Z[e.pageId])&&void 0!==t?t:{x:o.x,y:o.y,w:900,h:756},i=s-q.offsetX,n=c-q.offsetY,a=u(i),r=u(n),d=l.x+14,b=l.y+44,m=l.x+l.w-e.w-14,v=l.y+l.h-e.h-14;return{...e,x:x(a,d,m),y:x(r,b,v)}}));return}if("resizeTable"===q.kind){let e=q.id,i=_.find(t=>t.id===e);if(!i)return;let n=s-q.offsetX,a=c-q.offsetY,r=u((null!==(t=q.startW)&&void 0!==t?t:h(i).w)+n),d=u((null!==(l=q.startH)&&void 0!==l?l:h(i).h)+a);if(r=x(r,60,560),d=x(d,60,360),"TABLE_ROUND"===v(i)){let e=Math.max(r,d);r=e,d=e}eh(e,{w:r,h:d});return}if("resizeZone"===q.kind){let e=q.id,t=G.find(t=>t.id===e);if(!t)return;let l=s-q.offsetX,a=c-q.offsetY;ep(e,{w:u((null!==(i=q.startW)&&void 0!==i?i:t.w)+l),h:u((null!==(n=q.startH)&&void 0!==n?n:t.h)+a)});return}if("resizeWall"===q.kind){let e=q.id,t=W.find(t=>t.id===e);if(!t)return;let l=s-q.offsetX,i=c-q.offsetY;eg(e,{w:u((null!==(a=q.startW)&&void 0!==a?a:t.w)+l),h:u((null!==(r=q.startH)&&void 0!==r?r:t.h)+i)});return}},onPointerUp:ey,onPointerCancel:ey,onPointerLeave:ey,onPointerDown:e=>{if(!P.current)return;let t=P.current.getBoundingClientRect(),{x:l,y:i}=el(e.clientX-t.left,e.clientY-t.top);if(l>=ee.x+14&&l<=ee.x+ee.w-14&&i>=ee.y+44&&i<=ee.y+ee.h-14){if("zone"===U){let e={id:s(),pageId:M,x:u(l-120),y:u(i-80),w:240,h:160};e.x=x(e.x,ee.x+14,ee.x+ee.w-e.w-14),e.y=x(e.y,ee.y+44,ee.y+ee.h-e.h-14),Q(t=>[e,...t]),J({kind:"zone",id:e.id}),D("select"),en();return}if("wall"===U){let e={id:s(),pageId:M,x:u(l-140),y:u(i),w:280,h:10};e.x=x(e.x,ee.x+14,ee.x+ee.w-e.w-14),e.y=x(e.y,ee.y+44,ee.y+ee.h-e.h-14),Y(t=>[e,...t]),J({kind:"wall",id:e.id}),D("select"),en();return}J(null)}},children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-zinc-950/50 to-black/80"}),(0,i.jsx)("div",{className:"absolute inset-0 pointer-events-none shadow-[inset_0_0_120px_rgba(0,0,0,0.85)]"}),(0,i.jsx)("div",{className:"absolute inset-0 pointer-events-none opacity-[0.06]",style:{backgroundImage:"linear-gradient(to right, rgba(255,255,255,0.12) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,0.12) 1px, transparent 1px)",backgroundSize:"".concat(20,"px ").concat(20,"px")}}),(0,i.jsxs)("div",{className:"absolute rounded-2xl border border-zinc-800/80 overflow-hidden",style:{left:ee.x,top:ee.y,width:ee.w,height:ee.h},children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b ".concat(p[eT%p.length])}),(0,i.jsx)("div",{className:"absolute inset-0 bg-black/18"}),(0,i.jsxs)("div",{className:"relative h-11 px-4 flex items-center justify-between border-b border-zinc-800/70 bg-zinc-950/40",children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-200",children:S("MAP","MAP")}),(0,i.jsxs)("div",{className:"text-[10px] text-zinc-500 font-mono tabular-nums",children:[ee.w,"\xd7",ee.h]})]})]}),es.map(e=>{let t=(null==F?void 0:F.kind)==="zone"&&F.id===e.id,l=ei(e.x,e.y);return(0,i.jsxs)("div",{className:["absolute rounded-2xl border overflow-hidden",t?"border-amber-400/80":"border-zinc-800/80","bg-zinc-900/10"].join(" "),style:{left:l.x,top:l.y,width:e.w,height:e.h},onPointerDown:t=>{t.stopPropagation(),J({kind:"zone",id:e.id}),ef(t,"zone",e.id,e.x,e.y)},onClick:t=>{t.stopPropagation(),J({kind:"zone",id:e.id})},children:[e.label?(0,i.jsx)("div",{className:"absolute top-2 left-2 text-[10px] font-black px-2 py-1 rounded-lg border border-zinc-800 bg-black/40 text-zinc-200",children:e.label}):null,(0,i.jsx)("div",{className:"absolute right-1 bottom-1 h-4 w-4 rounded bg-zinc-950/70 border border-zinc-800 cursor-nwse-resize",onPointerDown:t=>{t.stopPropagation(),J({kind:"zone",id:e.id}),ew(t,"resizeZone",e.id,e.w,e.h)}})]},e.id)}),ec.map(e=>{let t=(null==F?void 0:F.kind)==="wall"&&F.id===e.id,l=ei(e.x,e.y);return(0,i.jsx)("div",{className:["absolute rounded border",t?"border-amber-400/80":"border-zinc-800/80","bg-zinc-500/40"].join(" "),style:{left:l.x,top:l.y,width:e.w,height:e.h},onPointerDown:t=>{t.stopPropagation(),J({kind:"wall",id:e.id}),ef(t,"wall",e.id,e.x,e.y)},onClick:t=>{t.stopPropagation(),J({kind:"wall",id:e.id})},children:(0,i.jsx)("div",{className:"absolute right-1 bottom-1 h-4 w-4 rounded bg-zinc-950/70 border border-zinc-800 cursor-nwse-resize",onPointerDown:t=>{t.stopPropagation(),J({kind:"wall",id:e.id}),ew(t,"resizeWall",e.id,e.w,e.h)}})},e.id)}),eo.map(e=>{var t,l;let n=(null==F?void 0:F.kind)==="table"&&F.id===e.id,a=v(e),{w:r,h:d}=h(e),o=ei(e.x,e.y),s=e.reservationName||(null==e?void 0:null===(t=e.reservation)||void 0===t?void 0:t.name)||(null==e?void 0:null===(l=e.reservation)||void 0===l?void 0:l.guestName)||(null==e?void 0:e.guestName)||"",c="TABLE_ROUND"===a;return(0,i.jsxs)("div",{className:["absolute border select-none backdrop-blur-md bg-black/35 overflow-hidden",c?"rounded-full":"rounded-2xl",n?"border-amber-400/90 shadow-[0_0_0_1px_rgba(245,158,11,0.35),0_10px_30px_rgba(0,0,0,0.55)]":"border-zinc-800/90 shadow-[0_10px_26px_rgba(0,0,0,0.55)]"].join(" "),style:{left:o.x,top:o.y,width:r,height:d},onPointerDown:t=>{t.stopPropagation(),J({kind:"table",id:e.id}),ef(t,"table",e.id,e.x,e.y)},onClick:t=>{t.stopPropagation(),J({kind:"table",id:e.id})},title:e.name,children:[(0,i.jsx)("div",{className:"absolute inset-0 pointer-events-none [background:radial-gradient(circle_at_30%_20%,rgba(255,255,255,0.10),transparent_55%)]"}),(0,i.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,i.jsx)("div",{className:c?"text-[18px] font-black text-white":"text-[16px] font-black text-white",children:e.name}),s?(0,i.jsx)("div",{className:"mt-1 text-[11px] font-semibold text-zinc-300 max-w-[90%] truncate",children:s}):null]}),(0,i.jsx)("div",{className:"absolute right-1 bottom-1 h-4 w-4 rounded bg-zinc-950/70 border border-zinc-800 cursor-nwse-resize",onPointerDown:t=>{t.stopPropagation(),J({kind:"table",id:e.id}),ew(t,"resizeTable",e.id,r,d)}})]},e.id)})]})]})]})]})}),V?(0,i.jsx)("div",{className:"fixed left-1/2 -translate-x-1/2 bottom-6 px-4 py-2 rounded-xl border border-zinc-800 bg-zinc-950/90 text-zinc-200 text-sm font-black shadow-[0_20px_60px_rgba(0,0,0,0.65)] backdrop-blur-xl",children:V}):null]})}function f(e){let{label:t,children:l}=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-[11px] font-black tracking-widest text-zinc-500",children:t}),(0,i.jsx)("div",{className:"mt-1",children:l})]})}function w(e){let{label:t,active:l,onClick:n}=e;return(0,i.jsx)("button",{onClick:n,className:["px-3 py-3 rounded-xl text-[11px] font-black border transition text-left",l?"bg-amber-500 text-black border-amber-400":"bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900"].join(" "),children:t})}let y="w-full rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500/80",N="px-4 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40",j="px-4 py-2 rounded-xl text-xs font-black border border-amber-400/70 bg-amber-500 text-black hover:bg-amber-400",k="px-3 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40",E="px-3 py-2 rounded-xl text-xs font-black border border-amber-400/70 bg-amber-500 text-black",z="px-3 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40"}},function(e){e.O(0,[459,310,971,23,744],function(){return e(e.s=1212)}),_N_E=e.O()}]);
(()=>{var e={};e.id=535,e.ids=[535],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},3409:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>b,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o}),s(1240),s(2758),s(5866);var a=s(3191),r=s(8716),n=s(7922),i=s.n(n),l=s(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let o=["",{children:["reservations",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1240)),"/Users/rohitchandnani/tasting-pos/app/reservations/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,2758)),"/Users/rohitchandnani/tasting-pos/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/rohitchandnani/tasting-pos/app/reservations/page.tsx"],x="/reservations/page",b={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/reservations/page",pathname:"/reservations",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},8539:(e,t,s)=>{Promise.resolve().then(s.bind(s,877))},5474:(e,t,s)=>{"use strict";s.d(t,{b:()=>l});var a=s(326),r=s(7577),n=s.n(r),i=s(2854);function l({tables:e,mode:t="service",storageKey:s,selectedReservationId:r,onDropReservationOnTable:l,onClickTable:d,activePageId:o,onChangePage:c}){let{t:x}=(0,i.Q)(),b=s||"tastingpos_room_active_map_page",[u,m]=n().useState(null),[p,h]=n().useState(o??null),g=u?.pages||[{id:"RESTAURANTE",label:x("RESTAURANTE","RESTAURANTE")}],v=p||(g[0]?.id??x("RESTAURANTE","RESTAURANTE")),N=u?.rectByPage?.[v]||{x:0,y:0,w:900,h:756},f=(u?.zones||[]).filter(e=>(e.pageId??e.main)===v),j=(u?.walls||[]).filter(e=>(e.pageId??e.main)===v),E=u?.tableById||{},z=e.filter(e=>{let t=E[e.id];return((t?.pageId??t?.main)||e.pageId||e.main)===v}).map(e=>{let t=E[e.id],s=t?.w??e.w??92,a=t?.h??e.h??92,r=t?.x??e.x??N.x+80,n=t?.y??e.y??N.y+80,i=t?.obj??e.obj??"TABLE_SQUARE";return{table:e,lt:{x:r,y:n,w:s,h:a,obj:i}}}),k=e=>{h(e),c?.(e);try{localStorage.setItem(b,e)}catch{}},S=e=>{"seating"===t&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},y=(e,s)=>{if("seating"!==t)return;e.preventDefault();let a=e.dataTransfer.getData("text/plain");a&&l?.(a,s)};return(0,a.jsxs)("div",{className:"h-full w-full",children:[a.jsx("div",{className:"flex items-center gap-2 mb-3",children:g.map(e=>a.jsx("button",{onClick:()=>k(e.id),className:["px-4 py-2 rounded-xl text-xs font-black border transition",v===e.id?"bg-amber-500 text-black border-amber-400":"bg-zinc-950/40 text-zinc-200 border-zinc-800 hover:bg-zinc-900/40"].join(" "),children:e.label},e.id))}),(0,a.jsxs)("div",{className:"relative rounded-2xl border border-zinc-800 bg-black/30 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"linear-gradient(to right, rgba(255,255,255,0.10) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,0.10) 1px, transparent 1px)",backgroundSize:"20px 20px",opacity:.06}}),a.jsx("div",{className:"absolute inset-0 pointer-events-none shadow-[inset_0_0_120px_rgba(0,0,0,0.85)]"}),a.jsx("div",{className:"relative p-4",children:(0,a.jsxs)("div",{className:"relative rounded-2xl border border-zinc-800/80 overflow-hidden bg-gradient-to-b from-zinc-950/40 to-black/40",style:{width:N.w,height:N.h},children:[f.map(e=>a.jsx("div",{className:"absolute rounded-2xl border border-zinc-800/80 bg-zinc-900/10",style:{left:e.x-N.x,top:e.y-N.y,width:e.w,height:e.h},children:e.label?a.jsx("div",{className:"absolute top-2 left-2 text-[10px] font-black px-2 py-1 rounded-lg border border-zinc-800 bg-black/40 text-zinc-200",children:e.label}):null},e.id)),j.map(e=>a.jsx("div",{className:"absolute rounded border border-zinc-800/80 bg-zinc-500/40",style:{left:e.x-N.x,top:e.y-N.y,width:e.w,height:e.h}},e.id)),z.map(({table:e,lt:s})=>{let n="ASSIGNED"===e.reservationStatus,i="SEATED"===e.reservationStatus||"SEATED"===e.status,l="TABLE_ROUND"===s.obj;return(0,a.jsxs)("div",{onClick:()=>d?.(e.id),onDragOver:S,onDrop:t=>y(t,e.id),className:["absolute select-none border backdrop-blur-md overflow-hidden",l?"rounded-full":"rounded-2xl",r&&"seating"===t?"cursor-pointer hover:scale-[1.01]":"cursor-default",i?"border-emerald-500/60 bg-black/40":n?"border-amber-500/60 bg-black/35":"border-zinc-800/90 bg-black/25"].join(" "),style:{left:s.x-N.x,top:s.y-N.y,width:s.w,height:s.h},title:e.name,children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none [background:radial-gradient(circle_at_30%_20%,rgba(255,255,255,0.10),transparent_55%)]"}),e.tableLanguage?a.jsx("div",{className:"absolute top-1 right-1 px-2 py-1 rounded-lg border border-zinc-800 bg-black/50 text-[10px] font-black text-zinc-200",children:e.tableLanguage}):null,(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[a.jsx("div",{className:"text-[14px] font-black text-white",children:e.name}),i&&e.reservationName?a.jsx("div",{className:"mt-1 text-[11px] font-semibold text-zinc-300 max-w-[90%] truncate",children:e.reservationName}):null,n&&!i&&e.reservationName?(0,a.jsxs)("div",{className:"mt-1 text-[11px] font-semibold text-amber-200 max-w-[90%] truncate",children:[x("Assigned","Assigned"),": ",e.reservationName]}):null,i||n||"seating"!==t?null:a.jsx("div",{className:"mt-1 text-[10px] text-zinc-500",children:x("Drop reservation","Drop reservation")})]})]},e.id)})]})}),a.jsx("div",{className:"px-4 pb-4 text-xs text-zinc-500",children:"seating"===t?x("Seating mode: drag reservation onto table","Seating mode: drag reservation onto table"):x("Service mode: map is read-only","Service mode: map is read-only")})]})]})}},877:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(326),r=s(7577),n=s.n(r),i=s(579),l=s(5474),d=s(2704),o=s(7451),c=s(2854);function x(){let{t:e}=(0,c.Q)(),{reservations:t,tables:s,assignReservationToTable:r,clearReservationFromTable:x,seatAssignedTable:p,updateReservation:h,updateReservationNote:g,addReservation:v,deleteReservation:N,setDraftMenu:f,setDraftGuestMenu:j,createDraftForReservation:E,markDraftPrepared:z,clearDraft:k,draftInsertCourse:S,draftDeleteCourse:y,draftMoveCourse:C,draftAddExtraDish:D,draftRemoveExtraDish:T,dishPresets:w,draftAddGuestSub:R,draftRemoveGuestSub:A,getEffectiveDraftSetupForTable:I}=(0,i.mr)(),[P,O]=n().useState(null),[L,U]=n().useState(null),[_,M]=n().useState(""),[G,V]=n().useState("NOT_SEATED"),[F,B]=n().useState(null),[W,H]=n().useState(()=>new Date().toISOString().slice(0,10)),[K,$]=n().useState("DINNER"),[q,X]=n().useState("PLAN"),[Q,J]=n().useState(null),Y=n().useMemo(()=>t.find(e=>e.id===P)||null,[t,P]),Z=n().useMemo(()=>t.find(e=>e.id===Q)||null,[t,Q]),ee=n().useMemo(()=>t.find(e=>e.id===F)||null,[t,F]),et=n().useMemo(()=>new Map(s.map(e=>[e.id,e])),[s]),es=t.filter(e=>(!e.date||e.date===W)&&(!e.service||e.service===K)).filter(e=>{let t=_.trim().toLowerCase();return!t||e.name?.toLowerCase().includes(t)||String(e.pax??"").includes(t)||e.time?.toLowerCase?.().includes(t)}).filter(e=>{let t=!!e.tableId;return"ALL"===G||("SEATED"===G?t:!t)}),ea=!!ee,er=n().useMemo(()=>{if(!ee)return null;let e={};return(0,i.NK)(ee.pax).forEach((t,s)=>{e[t]=s+1}),{...e,...ee.draftGuestSeatMap||{}}},[ee]),en=n().useMemo(()=>{if(!ee?.draftSetup)return null;let e={id:-1,name:ee.tablePref||"RES",pax:ee.pax,status:"SEATED",x:0,y:0,reservationName:ee.name,reservationPax:ee.pax,reservationTime:ee.time,language:ee.language,setup:ee.draftSetup},t={...ee,tableId:-1,draftGuestSeatMap:er||{}},s=I(t,t.pax||0);return{...e,setup:s??e.setup}},[ee,er,I]),ei=n().useCallback((e,a)=>{let n=t.find(t=>t.id===e);if(!n)return;let i=s.find(e=>e.id===a);if(i){if(("ASSIGNED"===i.reservationStatus||"SEATED"===i.reservationStatus)&&!window.confirm(`Table ${i.name} is already reserved. Replace?`))return;r(n,a),h(e,{tableId:a}),i.reservationId&&h(i.reservationId,{tableId:void 0}),"SERVICE"===q&&p(a),O(t=>t===e?null:t)}},[r,t,s,h,p,q]),el=n().useCallback(e=>{let s=t.find(t=>t.id===e);s?.tableId&&(x(s.tableId),h(e,{tableId:void 0}))},[x,t,h]),ed=(e,t)=>{e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="move"};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:["h-full w-full bg-[#0b0b0d] grid",ea?"md:grid-cols-[360px_1fr_380px]":"md:grid-cols-[380px_1fr]"].join(" "),children:[(0,a.jsxs)("aside",{className:"border-r border-zinc-800 bg-zinc-950 p-4 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-sm font-bold tracking-wide text-zinc-200",children:e("Reservations","Reservations")}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-zinc-500",children:t.length}),a.jsx("button",{onClick:()=>{let t=`r_${Math.random().toString(36).slice(2)}_${Date.now().toString(16)}`;v({id:t,name:e("New reservation","New reservation"),pax:2,language:"EN",date:W,service:K,status:"BOOKED",note:"",reservationNote:"",draftMenuId:o.ri().menus[0]?.id||"m_a",tags:[]}),J(t)},className:"px-4 py-2 rounded-xl text-xs font-black border border-amber-400 bg-amber-500 text-black hover:bg-amber-400",children:e("+ NEW","+ NEW")})]})]}),a.jsx("div",{className:"text-xs text-zinc-500 mb-3",children:e("Tap a reservation then tap a table, or drag it onto a table.","Tap a reservation then tap a table, or drag it onto a table.")}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[a.jsx("input",{type:"date",value:W,onChange:e=>H(e.target.value),className:"rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none"}),a.jsx("button",{onClick:()=>$("LUNCH"),className:["px-4 py-2 rounded-xl text-xs font-black border transition","LUNCH"===K?"bg-amber-500 text-black border-amber-400":"bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900"].join(" "),children:e("LUNCH","LUNCH")}),a.jsx("button",{onClick:()=>$("DINNER"),className:["px-4 py-2 rounded-xl text-xs font-black border transition","DINNER"===K?"bg-amber-500 text-black border-amber-400":"bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900"].join(" "),children:e("DINNER","DINNER")}),a.jsx("button",{onClick:()=>X("PLAN"),className:["px-4 py-2 rounded-xl text-xs font-black border transition","PLAN"===q?"bg-amber-500 text-black border-amber-400":"bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900"].join(" "),children:e("PLAN VIEW","PLAN VIEW")}),a.jsx("button",{onClick:()=>X("SERVICE"),className:["px-4 py-2 rounded-xl text-xs font-black border transition","SERVICE"===q?"bg-amber-500 text-black border-amber-400":"bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900"].join(" "),children:e("SERVICE VIEW","SERVICE VIEW")})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("input",{value:_,onChange:e=>M(e.target.value),placeholder:e("Search name / pax / time…","Search name / pax / time…"),className:"flex-1 rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500/80"}),(0,a.jsxs)("select",{value:G,onChange:e=>V(e.target.value),className:"rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none",children:[a.jsx("option",{value:"NOT_SEATED",children:e("Not seated","Not seated")}),a.jsx("option",{value:"SEATED",children:e("Seated","Seated")}),a.jsx("option",{value:"ALL",children:e("All","All")})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[es.map(t=>{let s=t.id===P;return(0,a.jsxs)("div",{draggable:!0,onDragStart:e=>ed(e,t.id),onClick:()=>O(s?null:t.id),className:["cursor-pointer select-none rounded-xl border p-3 transition",s?"border-amber-500/70 bg-amber-500/10":"border-zinc-800 bg-zinc-900/40 hover:bg-zinc-900/70"].join(" "),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-bold text-white",children:t.name}),(0,a.jsxs)("div",{className:"text-xs text-zinc-400 mt-0.5",children:[t.time," • ",t.pax," ",e("pax","pax")]}),t.tableId?(0,a.jsxs)("div",{className:"mt-1 text-xs font-black text-amber-300",children:[e("Assigned to","Assigned to")," ",et.get(t.tableId)?.name||`T${t.tableId}`]}):null]}),a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded border border-zinc-700 bg-zinc-900 text-zinc-200 font-bold",children:t.language})]}),a.jsx("div",{className:"mt-1 flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-[10px] px-2 py-0.5 rounded border border-zinc-700 bg-zinc-950 text-zinc-200 font-bold",children:[e("DRAFT","DRAFT")," ",t.draftStatus||"NONE"]})}),(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),U(L===t.id?null:t.id)},className:"text-[11px] font-black px-2 py-1 rounded-lg border border-zinc-800 bg-black/40 text-zinc-300 hover:bg-zinc-900/40",children:[e("Notes","Notes"),t.reservationNote?a.jsx("span",{className:"ml-2 text-[10px] font-black text-amber-300",children:e("NOTE","NOTE")}):null]}),a.jsx("button",{onClick:e=>{e.stopPropagation(),J(t.id)},className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40",children:e("EDIT","EDIT")})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2",children:[(t.draftStatus??"NONE")==="NONE"?a.jsx("button",{onClick:e=>{e.stopPropagation(),E(t.id),B(t.id)},className:"px-3 py-2 rounded-xl text-xs font-black border border-amber-500/60 bg-amber-500/10 text-amber-200 hover:bg-amber-500/20",children:e("CREATE DRAFT","CREATE DRAFT")}):null,(t.draftStatus??"NONE")==="DRAFT"?(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:e=>{e.stopPropagation(),B(t.id)},className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-700 bg-black/40 text-zinc-200 hover:bg-zinc-900/40",children:e("EDIT DRAFT","EDIT DRAFT")}),a.jsx("button",{onClick:e=>{e.stopPropagation(),z(t.id)},className:"px-3 py-2 rounded-xl text-xs font-black border border-green-600/60 bg-green-900/20 text-green-200 hover:bg-green-900/30",children:e("MARK PREPPED","MARK PREPPED")}),a.jsx("button",{onClick:e=>{e.stopPropagation(),k(t.id),F===t.id&&B(null)},className:"px-3 py-2 rounded-xl text-xs font-black border border-red-700 bg-red-900/20 text-red-200 hover:bg-red-900/30",children:e("CLEAR","CLEAR")})]}):null,(t.draftStatus??"NONE")==="PREPPED"?(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:e=>{e.stopPropagation(),B(t.id)},className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-700 bg-black/40 text-zinc-200 hover:bg-zinc-900/40",children:e("VIEW/EDIT","VIEW/EDIT")}),a.jsx("button",{onClick:e=>{e.stopPropagation(),h(t.id,{draftStatus:"DRAFT",draftUpdatedAt:Date.now()})},className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-700 bg-black/40 text-zinc-200 hover:bg-zinc-900/40",children:e("UNPREP","UNPREP")}),a.jsx("button",{onClick:e=>{e.stopPropagation(),k(t.id),F===t.id&&B(null)},className:"px-3 py-2 rounded-xl text-xs font-black border border-red-700 bg-red-900/20 text-red-200 hover:bg-red-900/30",children:e("CLEAR","CLEAR")})]}):null]}),L===t.id&&t.reservationNote?a.jsx("div",{className:"mt-2 text-xs text-zinc-300 rounded-xl border border-zinc-800 bg-black/40 p-2",children:t.reservationNote}):null,t.tableId?(0,a.jsxs)("div",{className:"mt-2 flex gap-2",children:[a.jsx("button",{onClick:e=>{e.stopPropagation(),el(t.id)},className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40",children:e("UNSEAT","UNSEAT")}),a.jsx("button",{onClick:e=>{e.stopPropagation(),O(t.id)},className:"px-3 py-2 rounded-xl text-xs font-black border border-amber-400/50 bg-amber-500/10 text-amber-200 hover:bg-amber-500/15",children:e("MOVE","MOVE")})]}):null,a.jsx("div",{className:"text-[10px] text-zinc-600 mt-2",children:e("Drag to table • Tap to select","Drag to table • Tap to select")})]},t.id)}),0===es.length&&a.jsx("div",{className:"text-sm text-zinc-500 border border-dashed border-zinc-800 rounded-xl p-4",children:e("No reservations match this filter.","No reservations match this filter.")})]}),(0,a.jsxs)("div",{className:"mt-4 border-t border-zinc-800 pt-3",children:[a.jsx("div",{className:"text-xs text-zinc-500",children:e("Selected","Selected")}),a.jsx("div",{className:"text-sm text-white font-bold",children:Y?`${Y.name} (${Y.pax})`:e("None","None")})]})]}),a.jsx("main",{className:"overflow-hidden bg-[#0f0f12]",children:ea?(0,a.jsxs)("div",{className:"hidden md:block h-full w-full p-6 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-black text-white",children:e("Draft Ticket","Draft Ticket")}),a.jsx("div",{className:"text-xs text-zinc-500",children:ee?.name})]}),a.jsx("button",{onClick:()=>B(null),className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40",children:e("CLOSE","CLOSE")})]}),ee?.draftSetup?a.jsx(b,{reservation:ee,dishPresets:w,onUpdateReservationNote:e=>g(ee.id,e),onSetDraftMenu:e=>f(ee.id,e),onSetDraftGuestMenu:(e,t)=>j(ee.id,e,t),onInsertCourseLine:(e,t,s)=>S(ee.id,e,t,s),onDeleteCourseLine:e=>y(ee.id,e),onMoveCourseLine:(e,t)=>C(ee.id,e,t),onAddExtraDish:(e,t)=>D(ee.id,e,t),onRemoveExtraDish:(e,t)=>T(ee.id,e,t),onAddGuestSub:(e,t,s)=>R(String(ee.id),e,t,s),onRemoveGuestSub:e=>A(String(ee.id),e)}):a.jsx("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-900/40 p-6 text-zinc-500",children:e("No draft setup yet. Create a draft to start editing.","No draft setup yet. Create a draft to start editing.")})]}):(0,a.jsxs)("div",{className:"h-full w-full p-6 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"px-3 py-2 rounded-lg border border-zinc-800 bg-black/60 text-xs text-zinc-300",children:[e("Mode","Mode"),": ",a.jsx("span",{className:"font-bold text-white",children:e("Seating","Seating")})]}),Y&&(0,a.jsxs)("div",{className:"px-3 py-2 rounded-lg border border-blue-700 bg-blue-900/30 text-xs text-blue-100",children:[e("Assign","Assign"),": ",a.jsx("span",{className:"font-bold",children:Y.name})]})]}),a.jsx(l.b,{mode:"seating",tables:s,storageKey:"tastingpos_res_active_map_page",selectedReservationId:P,onDropReservationOnTable:(e,t)=>ei(e,t),onClickTable:e=>{P&&(ei(P,e),O(null))}})]})}),ea?a.jsx("aside",{className:"hidden md:block h-full overflow-y-auto border-l border-zinc-800 bg-zinc-950 p-4",children:(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-950/40 p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"text-xs font-black text-zinc-200",children:e("DRAFT PREVIEW","DRAFT PREVIEW")}),a.jsx("div",{className:"text-[10px] font-black text-zinc-500",children:e("KDS ticket","KDS ticket")})]}),en?a.jsx("div",{className:"rounded-2xl border border-zinc-800 bg-black/30 p-2",children:a.jsx(d.wx,{table:en,mode:"PREVIEW",labelMode:"draft",guestSubs:ee?.draftGuestSubs||[],guestSeatMap:er||void 0})}):a.jsx("div",{className:"text-sm text-zinc-500",children:e("Create a draft to preview.","Create a draft to preview.")})]})}):null]}),ea?(0,a.jsxs)("div",{className:"md:hidden fixed inset-0 z-40 bg-[#0b0b0d] flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-zinc-800 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-sm font-black text-white",children:e("Draft Ticket","Draft Ticket")}),a.jsx("div",{className:"text-xs text-zinc-500",children:ee?.name})]}),a.jsx("button",{onClick:()=>B(null),className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40",children:e("CLOSE","CLOSE")})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[ee?.draftSetup?a.jsx(b,{reservation:ee,dishPresets:w,onUpdateReservationNote:e=>g(ee.id,e),onSetDraftMenu:e=>f(ee.id,e),onSetDraftGuestMenu:(e,t)=>j(ee.id,e,t),onInsertCourseLine:(e,t,s)=>S(ee.id,e,t,s),onDeleteCourseLine:e=>y(ee.id,e),onMoveCourseLine:(e,t)=>C(ee.id,e,t),onAddExtraDish:(e,t)=>D(ee.id,e,t),onRemoveExtraDish:(e,t)=>T(ee.id,e,t),onAddGuestSub:(e,t,s)=>R(String(ee.id),e,t,s),onRemoveGuestSub:e=>A(String(ee.id),e)}):a.jsx("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-900/40 p-6 text-zinc-500",children:e("No draft setup yet. Create a draft to start editing.","No draft setup yet. Create a draft to start editing.")}),(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-950/40 p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"text-xs font-black text-zinc-200",children:e("DRAFT PREVIEW","DRAFT PREVIEW")}),a.jsx("div",{className:"text-[10px] font-black text-zinc-500",children:e("KDS ticket","KDS ticket")})]}),en?a.jsx("div",{className:"rounded-2xl border border-zinc-800 bg-black/30 p-2",children:a.jsx(d.wx,{table:en,mode:"PREVIEW",labelMode:"draft",guestSubs:ee?.draftGuestSubs||[],guestSeatMap:er||void 0})}):a.jsx("div",{className:"text-sm text-zinc-500",children:e("Create a draft to preview.","Create a draft to preview.")})]})]})]}):null,Z?a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-end md:items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl border border-zinc-800 bg-[#0f0f12] overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800 flex items-center justify-between",children:[a.jsx("div",{className:"text-sm font-black text-white",children:e("Edit reservation","Edit reservation")}),a.jsx("button",{onClick:()=>J(null),className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40",children:e("CLOSE","CLOSE")})]}),(0,a.jsxs)("div",{className:"p-4 grid grid-cols-2 gap-3",children:[a.jsx(u,{label:e("Name","Name"),children:a.jsx("input",{className:m,value:Z.name,onChange:e=>h(Z.id,{name:e.target.value})})}),a.jsx(u,{label:e("Phone","Phone"),children:a.jsx("input",{className:m,value:Z.phone||"",onChange:e=>h(Z.id,{phone:e.target.value})})}),a.jsx(u,{label:e("Email","Email"),children:a.jsx("input",{className:m,value:Z.email||"",onChange:e=>h(Z.id,{email:e.target.value})})}),a.jsx(u,{label:e("Pax","Pax"),children:a.jsx("input",{type:"number",className:m,value:Z.pax,onChange:e=>h(Z.id,{pax:parseInt(e.target.value||"1",10)})})}),a.jsx(u,{label:e("Date","Date"),children:a.jsx("input",{type:"date",className:m,value:Z.date||W,onChange:e=>h(Z.id,{date:e.target.value})})}),a.jsx(u,{label:e("Service","Service"),children:(0,a.jsxs)("select",{className:m,value:Z.service||K,onChange:e=>h(Z.id,{service:e.target.value}),children:[a.jsx("option",{value:"LUNCH",children:e("LUNCH","LUNCH")}),a.jsx("option",{value:"DINNER",children:e("DINNER","DINNER")})]})}),a.jsx(u,{label:e("Status","Status"),children:(0,a.jsxs)("select",{className:m,value:Z.status||"BOOKED",onChange:e=>h(Z.id,{status:e.target.value}),children:[a.jsx("option",{value:"BOOKED",children:e("BOOKED","BOOKED")}),a.jsx("option",{value:"ARRIVED",children:e("ARRIVED","ARRIVED")}),a.jsx("option",{value:"NO_SHOW",children:e("NO SHOW","NO SHOW")}),a.jsx("option",{value:"CANCELLED",children:e("CANCELLED","CANCELLED")})]})}),a.jsx(u,{label:e("Channel","Channel"),children:a.jsx("input",{className:m,value:Z.channel||"",onChange:e=>h(Z.id,{channel:e.target.value})})}),(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-xs font-black text-zinc-300 mb-2",children:e("Reservation notes (hidden unless opened)","Reservation notes (hidden unless opened)")}),a.jsx("textarea",{className:`${m} min-h-[90px]`,value:Z.reservationNote||"",onChange:e=>g(Z.id,e.target.value)})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-xs font-black text-zinc-300 mb-2",children:e("Allergies (reservation level)","Allergies (reservation level)")}),a.jsx("input",{className:m,value:Z.allergies||"",onChange:e=>h(Z.id,{allergies:e.target.value})})]}),(0,a.jsxs)("div",{className:"col-span-2 flex items-center justify-between pt-2",children:[a.jsx("button",{onClick:()=>{N(Z.id),J(null)},className:"px-4 py-2 rounded-xl text-xs font-black border border-red-700 bg-red-900/20 text-red-200 hover:bg-red-900/30",children:e("DELETE","DELETE")}),a.jsx("div",{className:"text-xs text-zinc-500",children:e("Auto-saved (offline)","Auto-saved (offline)")})]})]})]})}):null]})}function b({reservation:e,dishPresets:t,onUpdateReservationNote:s,onSetDraftMenu:r,onSetDraftGuestMenu:l,onInsertCourseLine:x,onDeleteCourseLine:b,onMoveCourseLine:u,onAddExtraDish:m,onRemoveExtraDish:p,onAddGuestSub:h,onRemoveGuestSub:g}){let{t:v}=(0,c.Q)(),N=e.draftSetup,[f,j]=n().useState(null),[E,z]=n().useState("A"),[k,S]=n().useState(""),[y,C]=n().useState(!1),D=(0,i.NK)(e.pax||1),T=n().useCallback(e=>{let t=D[e-1];return t?`${v("Guest","Guest")} ${t}`:`${v("Seat","Seat")} ${e}`},[D]),w=n().useMemo(()=>(0,o.ri)().menus||[],[]),R=e.draftMenuId||N.menuId;return(0,a.jsxs)("div",{className:"mt-2 space-y-4",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-900/40 p-4",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[a.jsx("span",{className:"px-3 py-1 rounded border border-zinc-700 bg-zinc-950 text-sm font-black text-zinc-200",children:e.name}),(0,a.jsxs)("span",{className:"px-3 py-1 rounded border border-zinc-700 bg-zinc-950 text-sm font-black text-zinc-200",children:[e.pax," ",v("PAX","PAX")]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-[10px] font-black text-zinc-400",children:v("MENU","MENU")}),a.jsx("select",{value:R,onChange:t=>{(!e.draftGuestSubs||!(e.draftGuestSubs.length>0)||window.confirm(v("Changing menu may clear guest substitutions if courses don't match. Continue?","Changing menu may clear guest substitutions if courses don't match. Continue?")))&&r(t.target.value)},className:"rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm",children:w.map(e=>a.jsx("option",{value:e.id,children:e.label},e.id))})]})]}),(0,a.jsxs)("div",{className:"mt-3 rounded-xl border border-zinc-800 bg-black/40 overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>C(e=>!e),className:"w-full px-3 py-2 flex items-center justify-between text-left",children:[a.jsx("div",{className:"text-[10px] font-black text-zinc-300",children:v("RESERVATION NOTES","RESERVATION NOTES")}),a.jsx("div",{className:"text-[10px] font-black text-amber-300",children:y?v("HIDE","HIDE"):v("SHOW","SHOW")})]}),y?a.jsx("div",{className:"px-3 pb-3",children:a.jsx("textarea",{value:e.reservationNote||"",onChange:e=>s(e.target.value),onBlur:e=>s(e.target.value),placeholder:v("Add reservation notes…","Add reservation notes…"),className:"w-full min-h-[80px] rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500/80"})}):null]})]}),(0,a.jsxs)("div",{className:"mt-3 rounded-2xl border border-zinc-800 bg-zinc-900/40 overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800 bg-zinc-950",children:[a.jsx("div",{className:"text-sm font-black text-white",children:v("GUEST MENU (DRAFT)","GUEST MENU (DRAFT)")}),a.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:v("Choose menu per guest. Seat assignment happens in Room when they arrive.","Choose menu per guest. Seat assignment happens in Room when they arrive.")})]}),a.jsx("div",{className:"p-4 space-y-3",children:(0,i.NK)(e.pax).map(t=>{let s=e.draftGuestMenuMap?.[t]||e.draftGuestMenuId?.[t]||e.draftMenuId||w[0]?.id;return(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-black/40 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-white font-black",children:[v("Guest","Guest")," ",t]}),a.jsx("div",{className:"text-[10px] font-black text-zinc-500",children:v("Draft","Draft")})]}),(0,a.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3",children:[a.jsx("div",{className:"text-xs font-black text-zinc-300",children:v("MENU","MENU")}),a.jsx("select",{value:s,onChange:e=>l(t,e.target.value),className:"w-[220px] rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500/80",children:w.map(e=>a.jsx("option",{value:e.id,children:e.label},e.id))})]})]},t)})})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-900/40 overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800 bg-zinc-950 flex items-center justify-between",children:[a.jsx("div",{className:"text-sm font-black text-white",children:v("SUBSTITUTIONS PER GUEST","SUBSTITUTIONS PER GUEST")}),a.jsx("div",{className:"text-xs text-zinc-500",children:v("Tap a course → add guest substitutions","Tap a course → add guest substitutions")})]}),a.jsx("div",{className:"divide-y divide-zinc-800",children:N.courseLines.map(s=>{let r=(e.draftGuestSubs||[]).filter(e=>e.courseId===s.id);return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("button",{onClick:()=>j(e=>e===s.id?null:s.id),className:"w-full text-left flex items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(()=>{let t=(0,d.Di)(s,e.pax);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-white font-black",children:[(0,a.jsxs)("span",{className:"text-zinc-400 font-mono text-xs",children:["#",s.idx]})," ",t.baseCount,"x ",t.baseDish]}),t.exceptions.length>0?a.jsx("div",{className:"mt-1 text-xs text-zinc-400 space-y-1",children:t.exceptions.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-black text-zinc-300",children:[T(e.seat)," →"]})," ",e.dish]},e.seat))}):null]})})(),a.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:r.length>0?v("Guest substitutions set","Guest substitutions set"):v("No guest substitutions","No guest substitutions")})]}),a.jsx("div",{className:"text-xs font-black text-zinc-300",children:f===s.id?v("CLOSE","CLOSE"):v("EDIT","EDIT")})]}),f===s.id&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mt-4 rounded-2xl border border-zinc-800 bg-black/30 p-3",children:[a.jsx("div",{className:"text-xs font-black text-zinc-300",children:v("SUBSTITUTIONS PER GUEST (DRAFT)","SUBSTITUTIONS PER GUEST (DRAFT)")}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[a.jsx("select",{value:E,onChange:e=>z(e.target.value),className:"rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm font-black",children:D.map(e=>(0,a.jsxs)("option",{value:e,children:[v("Guest","Guest")," ",e]},e))}),a.jsx("input",{value:k,onChange:e=>S(e.target.value),placeholder:v("Type substitute (e.g. feijoa)","Type substitute (e.g. feijoa)"),className:"rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm"})]}),a.jsx("button",{onClick:()=>{k.trim()&&(h(s.id,E,k),S(""))},className:"mt-2 w-full rounded-xl bg-amber-500 text-black font-black py-2 text-sm",children:v("ADD SUBSTITUTION","ADD SUBSTITUTION")}),a.jsx("div",{className:"mt-3 space-y-2",children:0===r.length?a.jsx("div",{className:"text-xs text-zinc-500",children:v("No guest substitutions yet.","No guest substitutions yet.")}):r.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-xl border border-zinc-800 bg-black/40 px-3 py-2",children:[(0,a.jsxs)("div",{className:"text-sm text-white",children:[(0,a.jsxs)("span",{className:"font-black",children:[v("Guest","Guest")," ",e.guest]}),a.jsx("span",{className:"text-zinc-400",children:" — "}),a.jsx("span",{className:"font-semibold",children:e.text})]}),a.jsx("button",{onClick:()=>g(e.id),className:"rounded-lg border border-zinc-700 bg-black/40 px-2 py-1 text-xs font-black text-zinc-200",children:v("REMOVE","REMOVE")})]},e.id))})]}),(0,a.jsxs)("div",{className:"mt-4 rounded-xl border border-zinc-800 bg-black p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"text-[11px] font-black text-zinc-300",children:v("EXTRA DISHES (THIS COURSE)","EXTRA DISHES (THIS COURSE)")}),(0,a.jsxs)("select",{defaultValue:"",onChange:e=>{let t=e.target.value;if(t){if("__custom__"===t){let t=prompt(v("Extra dish name?","Extra dish name?"))?.trim()||"";t&&m(s.id,t),e.currentTarget.value="";return}m(s.id,t),e.currentTarget.value=""}},className:"rounded-lg bg-zinc-950 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500",children:[a.jsx("option",{value:"",children:v("+ Add dish…","+ Add dish…")}),t.map(e=>a.jsx("option",{value:e,children:e},e)),a.jsx("option",{value:"__custom__",children:v("Custom…","Custom…")})]})]}),a.jsx("div",{className:"mt-2 space-y-2",children:(N.extrasByCourseId?.[s.id]||[]).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2 rounded-lg border border-zinc-800 bg-zinc-950 p-2",children:[a.jsx("div",{className:"text-sm text-white font-black truncate",children:e}),a.jsx("button",{onClick:()=>p(s.id,t),className:"px-3 py-1.5 rounded-lg border border-zinc-700 bg-black/40 text-xs font-black text-zinc-200 hover:bg-zinc-900/40",children:v("DELETE","DELETE")})]},`${e}_${t}`))})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-700 bg-black/40 text-zinc-200 hover:bg-zinc-900/40",onClick:()=>{let e=prompt(v("Course name?","Course name?"))?.trim()||"";e&&x(s.id,"BEFORE",e)},children:v("+ ADD BEFORE","+ ADD BEFORE")}),a.jsx("button",{className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-700 bg-black/40 text-zinc-200 hover:bg-zinc-900/40",onClick:()=>{let e=prompt(v("Course name?","Course name?"))?.trim()||"";e&&x(s.id,"AFTER",e)},children:v("+ ADD AFTER","+ ADD AFTER")}),a.jsx("button",{className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-700 bg-black/40 text-zinc-200 hover:bg-zinc-900/40",onClick:()=>u(s.id,-1),children:v("↑ MOVE","↑ MOVE")}),a.jsx("button",{className:"px-3 py-2 rounded-xl text-xs font-black border border-zinc-700 bg-black/40 text-zinc-200 hover:bg-zinc-900/40",onClick:()=>u(s.id,1),children:v("↓ MOVE","↓ MOVE")}),a.jsx("button",{className:"px-3 py-2 rounded-xl text-xs font-black border border-red-700 bg-red-900/20 text-red-200 hover:bg-red-900/30",onClick:()=>b(s.id),children:v("DELETE COURSE","DELETE COURSE")})]})]})]},s.id)})})]})]})}function u({label:e,children:t}){return(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs font-black text-zinc-300 mb-2",children:e}),t]})}let m="w-full rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500/80"},1240:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var a=s(8570);let r=(0,a.createProxy)(String.raw`/Users/rohitchandnani/tasting-pos/app/reservations/page.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`/Users/rohitchandnani/tasting-pos/app/reservations/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,982,621,724,857],()=>s(3409));module.exports=a})();
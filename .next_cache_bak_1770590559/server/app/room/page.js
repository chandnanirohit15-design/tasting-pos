(()=>{var e={};e.id=261,e.ids=[261],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1017:e=>{"use strict";e.exports=require("path")},7310:e=>{"use strict";e.exports=require("url")},7783:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>b,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>o}),s(4304),s(2758),s(5866);var a=s(3191),r=s(8716),n=s(7922),i=s.n(n),l=s(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let o=["",{children:["room",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4304)),"/Users/rohitchandnani/tasting-pos/app/room/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,2758)),"/Users/rohitchandnani/tasting-pos/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/rohitchandnani/tasting-pos/app/room/page.tsx"],x="/room/page",b={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/room/page",pathname:"/room",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6073:(e,t,s)=>{Promise.resolve().then(s.bind(s,1847))},5474:(e,t,s)=>{"use strict";s.d(t,{b:()=>l});var a=s(326),r=s(7577),n=s.n(r),i=s(2854);function l({tables:e,mode:t="service",storageKey:s,selectedReservationId:r,onDropReservationOnTable:l,onClickTable:d,activePageId:o,onChangePage:c}){let{t:x}=(0,i.Q)(),b=s||"tastingpos_room_active_map_page",[p,m]=n().useState(null),[u,h]=n().useState(o??null),g=p?.pages||[{id:"RESTAURANTE",label:x("RESTAURANTE","RESTAURANTE")}],N=u||(g[0]?.id??x("RESTAURANTE","RESTAURANTE")),v=p?.rectByPage?.[N]||{x:0,y:0,w:900,h:756},f=(p?.zones||[]).filter(e=>(e.pageId??e.main)===N),j=(p?.walls||[]).filter(e=>(e.pageId??e.main)===N),E=p?.tableById||{},S=e.filter(e=>{let t=E[e.id];return((t?.pageId??t?.main)||e.pageId||e.main)===N}).map(e=>{let t=E[e.id],s=t?.w??e.w??92,a=t?.h??e.h??92,r=t?.x??e.x??v.x+80,n=t?.y??e.y??v.y+80,i=t?.obj??e.obj??"TABLE_SQUARE";return{table:e,lt:{x:r,y:n,w:s,h:a,obj:i}}}),z=e=>{h(e),c?.(e);try{localStorage.setItem(b,e)}catch{}},k=e=>{"seating"===t&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},y=(e,s)=>{if("seating"!==t)return;e.preventDefault();let a=e.dataTransfer.getData("text/plain");a&&l?.(a,s)};return(0,a.jsxs)("div",{className:"h-full w-full",children:[a.jsx("div",{className:"flex items-center gap-2 mb-3",children:g.map(e=>a.jsx("button",{onClick:()=>z(e.id),className:["px-4 py-2 rounded-xl text-xs font-black border transition",N===e.id?"bg-amber-500 text-black border-amber-400":"bg-zinc-950/40 text-zinc-200 border-zinc-800 hover:bg-zinc-900/40"].join(" "),children:e.label},e.id))}),(0,a.jsxs)("div",{className:"relative rounded-2xl border border-zinc-800 bg-black/30 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{backgroundImage:"linear-gradient(to right, rgba(255,255,255,0.10) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,0.10) 1px, transparent 1px)",backgroundSize:"20px 20px",opacity:.06}}),a.jsx("div",{className:"absolute inset-0 pointer-events-none shadow-[inset_0_0_120px_rgba(0,0,0,0.85)]"}),a.jsx("div",{className:"relative p-4",children:(0,a.jsxs)("div",{className:"relative rounded-2xl border border-zinc-800/80 overflow-hidden bg-gradient-to-b from-zinc-950/40 to-black/40",style:{width:v.w,height:v.h},children:[f.map(e=>a.jsx("div",{className:"absolute rounded-2xl border border-zinc-800/80 bg-zinc-900/10",style:{left:e.x-v.x,top:e.y-v.y,width:e.w,height:e.h},children:e.label?a.jsx("div",{className:"absolute top-2 left-2 text-[10px] font-black px-2 py-1 rounded-lg border border-zinc-800 bg-black/40 text-zinc-200",children:e.label}):null},e.id)),j.map(e=>a.jsx("div",{className:"absolute rounded border border-zinc-800/80 bg-zinc-500/40",style:{left:e.x-v.x,top:e.y-v.y,width:e.w,height:e.h}},e.id)),S.map(({table:e,lt:s})=>{let n="ASSIGNED"===e.reservationStatus,i="SEATED"===e.reservationStatus||"SEATED"===e.status,l="TABLE_ROUND"===s.obj;return(0,a.jsxs)("div",{onClick:()=>d?.(e.id),onDragOver:k,onDrop:t=>y(t,e.id),className:["absolute select-none border backdrop-blur-md overflow-hidden",l?"rounded-full":"rounded-2xl",r&&"seating"===t?"cursor-pointer hover:scale-[1.01]":"cursor-default",i?"border-emerald-500/60 bg-black/40":n?"border-amber-500/60 bg-black/35":"border-zinc-800/90 bg-black/25"].join(" "),style:{left:s.x-v.x,top:s.y-v.y,width:s.w,height:s.h},title:e.name,children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none [background:radial-gradient(circle_at_30%_20%,rgba(255,255,255,0.10),transparent_55%)]"}),e.tableLanguage?a.jsx("div",{className:"absolute top-1 right-1 px-2 py-1 rounded-lg border border-zinc-800 bg-black/50 text-[10px] font-black text-zinc-200",children:e.tableLanguage}):null,(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[a.jsx("div",{className:"text-[14px] font-black text-white",children:e.name}),i&&e.reservationName?a.jsx("div",{className:"mt-1 text-[11px] font-semibold text-zinc-300 max-w-[90%] truncate",children:e.reservationName}):null,n&&!i&&e.reservationName?(0,a.jsxs)("div",{className:"mt-1 text-[11px] font-semibold text-amber-200 max-w-[90%] truncate",children:[x("Assigned","Assigned"),": ",e.reservationName]}):null,i||n||"seating"!==t?null:a.jsx("div",{className:"mt-1 text-[10px] text-zinc-500",children:x("Drop reservation","Drop reservation")})]})]},e.id)})]})}),a.jsx("div",{className:"px-4 pb-4 text-xs text-zinc-500",children:"seating"===t?x("Seating mode: drag reservation onto table","Seating mode: drag reservation onto table"):x("Service mode: map is read-only","Service mode: map is read-only")})]})]})}},1847:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(326),r=s(7577),n=s.n(r),i=s(579),l=s(5474),d=s(2704),o=s(7451),c=s(2854);function x(){let{t:e}=(0,c.Q)(),{tables:t,hasAllergyFlag:s,getOnCourse:r}=(0,i.mr)(),[d,o]=n().useState(null),[x,b]=n().useState(!1),[m,u]=n().useState(!0),[h,g]=n().useState(!0),[N,v]=n().useState(!1),f=n().useCallback(e=>{o(e);try{localStorage.setItem("tastingpos_room_active_table",String(e))}catch{}},[]),j=n().useMemo(()=>t.find(e=>e.id===d)||null,[t,d]),E=j?j.reservationStatus??("SEATED"===j.status?"SEATED":"NONE"):"NONE",S=t.filter(e=>"SEATED"===e.status).length,z=a.jsx("div",{className:"w-full h-full overflow-hidden touch-none",children:a.jsx(l.b,{mode:"service",tables:t,storageKey:"tastingpos_room_active_map_page",onClickTable:e=>f(e)})}),k=j&&("ASSIGNED"===E||"SEATED"===E)?a.jsx(p,{table:j,showResNote:x,setShowResNote:b,showFohNote:m,setShowFohNote:u,showFullMenu:h,setShowFullMenu:g}):(0,a.jsxs)("div",{className:"text-zinc-500",children:[a.jsx("div",{className:"text-white font-black text-lg",children:e("Room Control","Room Control")}),a.jsx("div",{className:"mt-2",children:e("Select a seated table to manage it.","Select a seated table to manage it.")})]});return(0,a.jsxs)("div",{className:"h-full w-full bg-[#0f0f12] flex",children:[(0,a.jsxs)("div",{className:"flex-1 p-6 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-end justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-2xl font-black text-white",children:e("Room","Room")}),a.jsx("div",{className:"text-zinc-400 text-sm mt-1",children:e("Tap a table on the map to manage menu + pacing.","Tap a table on the map to manage menu + pacing.")})]}),(0,a.jsxs)("div",{className:"text-xs text-zinc-500",children:[e("Seated","Seated"),": ",a.jsx("span",{className:"text-white font-black",children:S})]})]}),a.jsx("div",{className:"mt-6",children:z})]}),a.jsx("aside",{className:"w-[520px] border-l border-zinc-800 bg-black p-6 overflow-y-auto",children:k})]})}function b({kind:e,t}){return"NONE"===e?a.jsx("span",{className:"text-[10px] font-black px-2 py-1 rounded border border-zinc-700 bg-zinc-950 text-zinc-300",children:t("NOT SENT","NOT SENT")}):"PENDING"===e?a.jsx("span",{className:"text-[10px] font-black px-2 py-1 rounded border border-amber-600 bg-amber-900/25 text-amber-200",children:t("PENDING","PENDING")}):a.jsx("span",{className:"text-[10px] font-black px-2 py-1 rounded border border-green-600 bg-green-900/25 text-green-200",children:t("APPROVED","APPROVED")})}function p({table:e,showResNote:t,setShowResNote:s,showFohNote:r,setShowFohNote:l,showFullMenu:x,setShowFullMenu:p}){let{sendForApproval:u,setPaused:h,fireNextOrRefire:g,hasAllergyFlag:N,getOnCourse:v,setMenuForTable:f,setPairing:j,setAllergy:E,setWineOverride:S,setFohNote:z,toggleWineMenuPassed:k,toggleWineOrdered:y,clearReservationFromTable:w,setTableLanguage:A,setSeatMenu:T,getFireCooldownSeconds:I,reservations:R,draftAssignGuestToSeat:P,draftRemoveGuestSub:G,draftSetGuestMenu:O,getEffectiveDraftSetupForTable:D}=(0,i.mr)(),{t:C}=(0,c.Q)(),[M,U]=n().useState(()=>Date.now()),_="ASSIGNED"===(e.reservationStatus??("SEATED"===e.status?"SEATED":"NONE")),F="SEATED"===e.status,L=n().useMemo(()=>e.reservationId&&R.find(t=>t.id===e.reservationId)||null,[R,e.reservationId]),W=F?e.setup:L?.draftSetup,$=n().useMemo(()=>{if(!L)return null;let t=L.pax||e.pax;return D(L,t)},[L,e.pax,D]),V=W?.approval??"NONE",H=n().useMemo(()=>(0,o.ri)(),[]).menus||[],B=H.find(e=>e.id===W?.menuId)?.label||C("Menu","Menu"),q=n().useRef(null),K=n().useRef(null),[X,Q]=n().useState(!0),Y=(0,i.NK)(e.pax||L?.pax||1),J=n().useMemo(()=>new Set(Object.values(L?.draftGuestSeatMap||{}).filter(e=>"number"==typeof e&&e>0)),[L?.draftGuestSeatMap]),Z=n().useMemo(()=>{if(!L?.draftSetup)return null;let t=L.pax||e.pax,s=D(L,t);return{id:-1,name:e.name,pax:t,status:"SEATED",x:0,y:0,reservationName:L.name,reservationPax:L.pax,reservationTime:L.time,language:L.language,setup:s||L.draftSetup}},[L,e.name,e.pax,D]),ee=W?.courseLines||[],et=ee.find(e=>"PENDING"===e.status),es=ee.find(e=>"FIRED"===e.status)||null,ea=ee.filter(e=>"PENDING"===e.status).slice(0,3),er=!!W?.pairing,en=N(e),ei=v(e),el=n().useCallback(e=>{if(!W?.pairing||!W.menuId)return null;let t=W.wineOverrideByCourseId?.[e.id],s=(0,o.$J)(W.menuId,e.idx);return t||s?.wineName||null},[W]),ed=_?{label:C("ASSIGNED","ASSIGNED"),className:"border-amber-600 bg-amber-900/25 text-amber-200"}:W?.paused?{label:C("PAUSED","PAUSED"),className:"border-purple-600 bg-purple-900/20 text-purple-200"}:"PENDING"===V?{label:C("APPROVAL PENDING","APPROVAL PENDING"),className:"border-amber-600 bg-amber-900/25 text-amber-200"}:"APPROVED"===V?{label:C("APPROVED","APPROVED"),className:"border-green-600 bg-green-900/25 text-green-200"}:{label:C("SEATED","SEATED"),className:"border-zinc-700 bg-zinc-950 text-zinc-300"},eo="NONE"===V&&F,ec=I(e),ex=ec>0,eb="APPROVED"===V&&!!W?.paused&&!!W?.pausedAfterLastFire&&!!W?.lastFiredCourseId&&!ex,ep="APPROVED"===V&&!W?.paused&&!!et&&!ex,em=ep||eb,eu=eb?C("REFIRE LAST FIRED","REFIRE LAST FIRED"):C("FIRE NEXT COURSE","FIRE NEXT COURSE"),eh=em?"":ex?`${C("Wait","Wait")} ${ec}s`:"APPROVED"!==V?C("Waiting approval","Waiting approval"):W?.paused?C("Table paused","Table paused"):et?"":C("Nothing to fire","Nothing to fire"),eg=!F;return(0,a.jsxs)("div",{children:[W?(0,a.jsxs)("div",{className:"sticky top-0 z-20 rounded-2xl border border-zinc-800 bg-[#0f0f12]/95 backdrop-blur p-3 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{disabled:!ep||eg,onClick:()=>{eg||g(e.id)},className:["flex-1 px-4 py-3 rounded-2xl font-black border text-sm transition",ep&&!eg?"bg-amber-500 text-black border-amber-400 hover:bg-amber-400":"bg-zinc-950 text-zinc-500 border-zinc-800 cursor-not-allowed"].join(" "),children:C("FIRE NEXT","FIRE NEXT")}),a.jsx("button",{disabled:eg,onClick:()=>{eg||h(e.id,!W.paused)},className:["px-4 py-3 rounded-2xl font-black border text-sm transition",W.paused&&!eg?"bg-red-500 text-black border-red-400 hover:bg-red-400":eg?"bg-zinc-950 text-zinc-600 border-zinc-800 cursor-not-allowed":"bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900"].join(" "),children:W.paused?C("RESUME","RESUME"):C("PAUSE","PAUSE")}),a.jsx("button",{onClick:()=>s(e=>!e),className:"px-4 py-3 rounded-2xl font-black border text-sm bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900",children:C("RES NOTES","RES NOTES")}),a.jsx("button",{onClick:()=>l(e=>!e),className:"px-4 py-3 rounded-2xl font-black border text-sm bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900",children:C("FOH NOTE","FOH NOTE")}),L?a.jsx("button",{onClick:()=>Q(e=>!e),className:"px-4 py-3 rounded-2xl font-black border text-sm bg-zinc-950 text-zinc-200 border-zinc-800 hover:bg-zinc-900",children:C("GUEST MAPPING","GUEST MAPPING")}):null]}),ep?null:W.approval&&"APPROVED"===W.approval?W.paused?a.jsx("div",{className:"mt-2 text-xs font-black text-red-300",children:C("Table paused","Table paused")}):null:a.jsx("div",{className:"mt-2 text-xs font-black text-amber-300",children:C("Waiting kitchen approval","Waiting kitchen approval")})]}):null,r&&W?(0,a.jsxs)("div",{className:"mb-4 rounded-2xl border border-zinc-800 bg-zinc-950/40 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("FOH NOTES","FOH NOTES")}),a.jsx("div",{className:"text-[10px] text-zinc-500",children:C("Kitchen cannot see this","Kitchen cannot see this")})]}),a.jsx("textarea",{value:W.fohNote||"",onChange:t=>z(e.id,t.target.value),placeholder:C("Server notes… (VIP mood, pacing requests, birthdays, who pays, etc.)","Server notes… (VIP mood, pacing requests, birthdays, who pays, etc.)"),className:"mt-3 w-full min-h-[70px] rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500/80"}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 rounded-xl border border-zinc-800 bg-black/40 text-xs font-black text-zinc-200",children:[a.jsx("input",{type:"checkbox",checked:!!W.wineMenuPassed,onChange:()=>k(e.id)}),C("Wine menu passed","Wine menu passed")]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 rounded-xl border border-zinc-800 bg-black/40 text-xs font-black text-zinc-200",children:[a.jsx("input",{type:"checkbox",checked:!!W.wineOrdered,onChange:()=>y(e.id)}),C("Wine ordered","Wine ordered")]})]})]}):null,a.jsx("div",{className:"flex items-start justify-between gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-white font-black text-2xl",children:e.name}),e.tableLanguage?a.jsx("div",{className:"ml-2 px-2 py-1 rounded-lg border border-zinc-800 bg-black/40 text-[10px] font-black text-zinc-200",children:e.tableLanguage}):null,a.jsx("span",{className:["text-[10px] font-black px-2 py-1 rounded border",ed.className].join(" "),children:ed.label})]}),(0,a.jsxs)("div",{className:"text-zinc-400 text-sm mt-1",children:[e.reservationName," • ",e.pax," ",C("pax","pax")," • ",e.language]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2 items-center",children:[(0,a.jsxs)("span",{className:"text-[10px] font-black px-2 py-1 rounded border border-zinc-800 bg-zinc-950 text-zinc-200",children:[C("MENU","MENU")," ",B]}),a.jsx(b,{kind:V,t:C}),er&&a.jsx("span",{className:"text-[10px] font-black px-2 py-1 rounded border border-indigo-600 bg-indigo-900/20 text-indigo-200",children:C("PAIRING","PAIRING")}),en&&a.jsx("span",{className:"text-[10px] font-black px-2 py-1 rounded border border-red-600 bg-red-900/20 text-red-200",children:C("ALLERGY","ALLERGY")}),W?.paused&&a.jsx("span",{className:"text-[10px] font-black px-2 py-1 rounded border border-purple-600 bg-purple-900/20 text-purple-200",children:C("PAUSED","PAUSED")})]}),(0,a.jsxs)("div",{className:"mt-3 text-sm text-zinc-300",children:[C("On course","On course"),":"," ",a.jsx("span",{className:"text-white font-black",children:null!==ei?`#${ei}`:"—"})]})]})}),e.reservationNote?(0,a.jsxs)("div",{className:"mt-4 rounded-2xl border border-zinc-800 bg-zinc-950/40 overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>s(e=>!e),className:"w-full px-4 py-3 flex items-center justify-between text-left",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("RESERVATION NOTES","RESERVATION NOTES")}),a.jsx("div",{className:"text-xs font-black text-amber-300",children:t?C("HIDE","HIDE"):C("SHOW","SHOW")})]}),t?a.jsx("div",{className:"px-4 pb-4 text-sm text-zinc-200",children:e.reservationNote}):null]}):null,_&&!F&&Z?(0,a.jsxs)("div",{className:"mt-4 rounded-2xl border border-zinc-800 bg-zinc-950/40 p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"text-xs font-black text-zinc-200",children:C("DRAFT TICKET PREVIEW (FOH)","DRAFT TICKET PREVIEW (FOH)")}),a.jsx("div",{className:"text-[10px] font-black text-zinc-500",children:C("Reservation draft","Reservation draft")})]}),a.jsx("div",{className:"rounded-2xl border border-zinc-800 bg-black/30 p-2",children:a.jsx(d.wx,{table:Z,mode:"PREVIEW",labelMode:L?.draftGuestSeatMap&&Y.every(e=>L.draftGuestSeatMap?.[e])?"approval":"draft",guestSubs:L?.draftGuestSubs||[],guestSeatMap:L?.draftGuestSeatMap||void 0})})]}):null,_&&!F&&L?(0,a.jsxs)("div",{className:"mt-4 rounded-2xl border border-zinc-800 bg-zinc-950/40 p-4",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("GUEST SUBSTITUTIONS","GUEST SUBSTITUTIONS")}),a.jsx("div",{className:"text-[10px] text-zinc-500 mt-1",children:C("Draft guest notes (pre-seat)","Draft guest notes (pre-seat)")}),a.jsx("div",{className:"mt-3 space-y-2",children:0===(L.draftGuestSubs||[]).length?a.jsx("div",{className:"text-xs text-zinc-500",children:C("No guest substitutions yet.","No guest substitutions yet.")}):(L.draftGuestSubs||[]).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between rounded-xl border border-zinc-800 bg-black/40 px-3 py-2",children:[(0,a.jsxs)("div",{className:"text-sm text-white",children:[(0,a.jsxs)("span",{className:"font-black",children:[C("Guest","Guest")," ",e.guest]}),a.jsx("span",{className:"text-zinc-400",children:" — "}),a.jsx("span",{className:"font-semibold",children:e.text})]}),a.jsx("button",{onClick:()=>G(L.id,e.id),className:"rounded-lg border border-zinc-700 bg-black/40 px-2 py-1 text-xs font-black text-zinc-200",children:C("REMOVE","REMOVE")})]},e.id))})]}):null,X&&L?(0,a.jsxs)("div",{className:"mt-4 rounded-2xl border border-zinc-800 bg-zinc-950/40 p-4",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("GUEST MAPPING","GUEST MAPPING")}),a.jsx("div",{className:"text-[10px] text-zinc-500 mt-1",children:C("Assign Guest A/B to seats for approval.","Assign Guest A/B to seats for approval.")}),a.jsx("div",{className:"mt-3 space-y-2",children:Y.map(t=>(0,a.jsxs)("div",{className:"rounded-xl border border-zinc-800 bg-black/30 p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"text-sm text-zinc-200 font-black",children:[C("Guest","Guest")," ",t]}),a.jsx("div",{className:"text-[10px] text-zinc-500",children:L.draftGuestSeatMap?.[t]?`${C("Seat","Seat")} ${L.draftGuestSeatMap?.[t]}`:C("Unassigned","Unassigned")})]}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[(0,a.jsxs)("select",{value:L.draftGuestSeatMap?.[t]||"",onChange:e=>{let s=e.target.value;P(L.id,t,s?Number(s):0)},className:"rounded-lg bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm w-[130px]",children:[a.jsx("option",{value:"",children:C("Seat…","Seat…")}),Array.from({length:e.pax||0},(e,t)=>t+1).map(e=>(0,a.jsxs)("option",{value:e,disabled:J.has(e)&&L.draftGuestSeatMap?.[t]!==e,children:[C("Seat","Seat")," ",e]},e))]}),a.jsx("select",{value:L.draftGuestMenuId?.[t]||L.draftMenuId||H[0]?.id,onChange:e=>O(L.id,t,e.target.value),className:"rounded-lg bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm w-[160px]",children:H.map(e=>a.jsx("option",{value:e.id,children:e.label},e.id))})]})]},t))}),a.jsx("div",{className:"mt-3 text-xs text-zinc-400",children:Y.map(e=>{let t=L.draftGuestSeatMap?.[e];return t?`${C("Guest","Guest")} ${e} → ${C("Seat","Seat")} ${t}`:null}).filter(Boolean).join(" • ")||C("No guest assignments yet.","No guest assignments yet.")})]}):null,_?(0,a.jsxs)("div",{className:"mt-4 rounded-2xl border border-amber-500/40 bg-amber-500/10 p-4",children:[a.jsx("div",{className:"text-sm font-black text-white",children:C("TABLE ASSIGNED","TABLE ASSIGNED")}),a.jsx("div",{className:"text-xs text-zinc-300 mt-1",children:C("Notes visible. Service controls locked until seated.","Notes visible. Service controls locked until seated.")}),(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[a.jsx("button",{onClick:()=>A(e.id,"ING"),disabled:F,className:["px-4 py-2 rounded-xl text-xs font-black border transition",F?"border-zinc-800 bg-zinc-900/40 text-zinc-600 cursor-not-allowed":"border-amber-400 bg-amber-500 text-black hover:bg-amber-400"].join(" "),children:"ING"}),a.jsx("button",{onClick:()=>A(e.id,"CAST"),disabled:F,className:["px-4 py-2 rounded-xl text-xs font-black border transition",F?"border-zinc-800 bg-zinc-900/40 text-zinc-600 cursor-not-allowed":"border-amber-400 bg-amber-500 text-black hover:bg-amber-400"].join(" "),children:"CAST"}),a.jsx("button",{onClick:()=>A(e.id,"CAT"),disabled:F,className:["px-4 py-2 rounded-xl text-xs font-black border transition",F?"border-zinc-800 bg-zinc-900/40 text-zinc-600 cursor-not-allowed":"border-amber-400 bg-amber-500 text-black hover:bg-amber-400"].join(" "),children:"CAT"}),a.jsx("button",{onClick:()=>w(e.id),className:"px-4 py-2 rounded-xl text-xs font-black border border-zinc-800 bg-black/35 text-zinc-200 hover:bg-zinc-900/40 transition",children:C("CLEAR ASSIGNMENT","CLEAR ASSIGNMENT")})]})]}):null,F&&W?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mt-6 rounded-2xl border border-zinc-800 bg-zinc-900/40 overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800 bg-zinc-950 flex items-center justify-between",children:[a.jsx("div",{className:"text-sm font-black text-white",children:C("SETUP","SETUP")}),a.jsx("div",{className:"text-xs text-zinc-500",children:eo?C("Edit before sending","Edit before sending"):C("Locked after sending","Locked after sending")})]}),(0,a.jsxs)("div",{className:"p-4 space-y-5",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-950/40 p-4",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("MENU PER SEAT","MENU PER SEAT")}),a.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:C("Select a menu for each seat (before approval).","Select a menu for each seat (before approval).")}),a.jsx("div",{className:"mt-3 space-y-2",children:Array.from({length:e.pax},(e,t)=>t+1).map(t=>(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"text-sm font-black text-zinc-200",children:[C("Seat","Seat")," ",t]}),a.jsx("select",{disabled:!eo,value:$?.seatMenuId?.[t]||W.seatMenuId?.[t]||H[0]?.id,onChange:s=>T(e.id,t,s.target.value),className:["rounded-xl bg-black/60 border border-zinc-800 text-white px-3 py-2 text-sm outline-none w-[170px]",eo?"focus:border-amber-500/80":"opacity-50 cursor-not-allowed"].join(" "),children:H.map(e=>a.jsx("option",{value:e.id,children:e.label},e.id))})]},t))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs font-black text-zinc-300",children:C("WINE PAIRING","WINE PAIRING")}),a.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:C("Shows “PAIRING” on KDS ticket.","Shows “PAIRING” on KDS ticket.")})]}),a.jsx("button",{disabled:!eo,onClick:()=>j(e.id,!W.pairing),className:["px-4 py-2 rounded-xl font-black border transition",W.pairing?"bg-indigo-600 border-indigo-500 text-white hover:bg-indigo-500":"bg-zinc-950 border-zinc-800 text-zinc-200 hover:bg-zinc-900",eo?"":"opacity-50 cursor-not-allowed"].join(" "),children:W.pairing?C("PAIRING ON","PAIRING ON"):C("NO PAIRING","NO PAIRING")})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs font-black text-zinc-300 mb-2",children:C("SEAT NOTES (ALLERGY / PREF) — visible in Approval + KDS","SEAT NOTES (ALLERGY / PREF) — visible in Approval + KDS")}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:Array.from({length:e.pax}).map((t,s)=>{let r=s+1,n=W.allergiesBySeat?.[r]??"";return(0,a.jsxs)("div",{className:"rounded-xl border border-zinc-800 bg-black p-3",children:[(0,a.jsxs)("div",{className:"text-[11px] font-black text-zinc-300 mb-2",children:[C("Seat","Seat")," ",r]}),a.jsx("input",{disabled:!eo,value:n,onChange:t=>E(e.id,r,t.target.value),placeholder:C("e.g. no shellfish / vegan / preference…","e.g. no shellfish / vegan / preference…"),className:["w-full rounded-lg bg-zinc-950 border border-zinc-800 text-white px-3 py-2 text-sm outline-none focus:border-amber-500",eo?"":"opacity-60 cursor-not-allowed"].join(" ")})]},r)})})]})]})]}),(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[a.jsx("button",{disabled:"NONE"!==V,onClick:()=>u(e.id),className:["rounded-2xl font-black py-3 text-black transition","NONE"===V?"bg-green-600 hover:bg-green-500":"bg-zinc-800 text-zinc-500 cursor-not-allowed"].join(" "),children:C("SEND TO KITCHEN","SEND TO KITCHEN")}),a.jsx("button",{onClick:()=>h(e.id,!W.paused),className:["rounded-2xl font-black py-3 border transition",W.paused?"bg-purple-600 border-purple-500 text-white hover:bg-purple-500":"bg-zinc-950 border-zinc-800 text-zinc-200 hover:bg-zinc-900"].join(" "),children:W.paused?C("RESUME","RESUME"):C("PAUSE","PAUSE")}),(0,a.jsxs)("button",{disabled:!em,onClick:()=>g(e.id),className:["rounded-2xl font-black py-3 text-black transition col-span-2",em?"bg-amber-500 hover:bg-amber-400":"bg-zinc-800 text-zinc-500 cursor-not-allowed"].join(" "),children:[em?eu:C("FIRE NEXT","FIRE NEXT"),eh?a.jsx("div",{className:"text-xs font-bold mt-1",children:eh}):null]}),a.jsx("div",{className:"col-span-2 text-xs text-zinc-500",children:C("Rule: can’t fire again for 60s. Refire only while paused.","Rule: can’t fire again for 60s. Refire only while paused.")})]}),(0,a.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-950/40 overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800 flex items-center justify-between",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("NOW","NOW")}),es?(0,a.jsxs)("div",{className:"text-xs text-zinc-500",children:["#",es.idx]}):null]}),a.jsx("div",{className:"p-4",children:es?a.jsx(m,{course:es,pax:e.pax,wineLabel:el(es),extras:W.extrasByCourseId?.[es.id]||[],onEditPairing:er?()=>{let t=el(es)??"",s=prompt(`${C("Wine for course","Wine for course")} #${es.idx} (${es.name})`,t)??"";S(e.id,es.id,s.trim())}:null}):a.jsx("div",{className:"text-sm text-zinc-500",children:C("Nothing fired yet.","Nothing fired yet.")})})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-950/40 overflow-hidden",children:[(0,a.jsxs)("div",{className:"px-4 py-3 border-b border-zinc-800 flex items-center justify-between",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("NEXT","NEXT")}),(0,a.jsxs)("div",{className:"text-xs text-zinc-500",children:[ea.length," ",C("items","items")]})]}),(0,a.jsxs)("div",{className:"p-4 space-y-2",children:[ea.map(t=>a.jsx("div",{className:"rounded-xl border border-zinc-800 bg-black/40 p-3",children:a.jsx(m,{course:t,pax:e.pax,wineLabel:el(t),extras:W.extrasByCourseId?.[t.id]||[],onEditPairing:er?()=>{let s=el(t)??"",a=prompt(`${C("Wine for course","Wine for course")} #${t.idx} (${t.name})`,s)??"";S(e.id,t.id,a.trim())}:null})},t.id)),ea.length?null:a.jsx("div",{className:"text-sm text-zinc-500",children:C("No pending courses.","No pending courses.")})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl border border-zinc-800 bg-zinc-950/40 overflow-hidden",children:[(0,a.jsxs)("button",{onClick:()=>p(e=>!e),className:"w-full px-4 py-3 border-b border-zinc-800 flex items-center justify-between text-left",children:[a.jsx("div",{className:"text-xs font-black text-white",children:C("FULL MENU","FULL MENU")}),a.jsx("div",{className:"text-xs font-black text-amber-300",children:x?C("HIDE","HIDE"):C("SHOW","SHOW")})]}),x?a.jsx("div",{ref:q,className:"max-h-[420px] overflow-y-auto p-4 space-y-2",children:ee.map(t=>a.jsx("div",{ref:"FIRED"===t.status?K:void 0,className:["rounded-xl border p-3","FIRED"===t.status?"border-amber-500/60 bg-amber-500/10":"border-zinc-800 bg-black/30"].join(" "),children:a.jsx(m,{course:t,pax:e.pax,wineLabel:el(t),extras:W.extrasByCourseId?.[t.id]||[],onEditPairing:er?()=>{let s=el(t)??"",a=prompt(`${C("Wine for course","Wine for course")} #${t.idx} (${t.name})`,s)??"";S(e.id,t.id,a.trim())}:null})},t.id))}):null]})]})]}):null]})}function m({course:e,pax:t,wineLabel:s,extras:r,onEditPairing:n}){let{t:i}=(0,c.Q)(),l=e.name,d=e.seatDish||{},o=new Set(Object.entries(e.seatSubs||{}).filter(([,e])=>(e||"").trim().length>0).map(([e])=>Number(e))),x=Object.entries(d).map(([e,t])=>({seat:Number(e),dish:t||""})).filter(e=>e.dish).filter(e=>e.dish!==l&&!o.has(e.seat)),{baseCount:b,subSeatLines:p}=function(e,t){let s=Object.entries(e.seatSubs||{}).map(([e,t])=>({seat:Number(e),sub:(t||"").trim()})).filter(e=>e.sub.length>0).sort((e,t)=>e.seat-t.seat);return{baseCount:Math.max(0,t-s.length),subSeatLines:s.map(e=>({key:`S${e.seat}_${e.sub}`,seat:e.seat,sub:e.sub}))}}(e,t);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"text-white font-black",children:[(0,a.jsxs)("span",{className:"text-zinc-400 font-mono text-xs",children:["#",e.idx]})," ",l," ",b>0?(0,a.jsxs)("span",{className:"text-zinc-400 font-black",children:[b,"x"]}):null]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s?n?a.jsx("button",{onClick:n,className:"text-xs font-black text-indigo-200 px-2 py-1 rounded-lg border border-indigo-700 bg-indigo-900/20 hover:bg-indigo-900/35 transition",title:i("Tap to change wine (FOH only)","Tap to change wine (FOH only)"),children:s}):a.jsx("div",{className:"text-xs font-black text-indigo-200 px-2 py-1 rounded-lg border border-indigo-700 bg-indigo-900/20",children:s}):null,a.jsx("div",{className:"text-xs font-black px-2 py-1 rounded-lg border border-zinc-800 bg-black/40 text-zinc-200",children:i(e.status,e.status)})]})]}),x.length>0?a.jsx("div",{className:"mt-2 text-xs text-zinc-300 space-y-1",children:x.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-black text-zinc-200",children:[i("Seat","Seat")," ",e.seat,":"]})," ",e.dish]},e.seat))}):null,p.length>0&&a.jsx("div",{className:"mt-2 text-[11px] text-zinc-300 space-y-0.5",children:p.map(e=>(0,a.jsxs)("div",{children:[i("Seat","Seat")," ",e.seat," — ",e.sub," 1x"]},e.key))}),r.length>0?a.jsx("div",{className:"mt-2 text-[11px] text-zinc-200 space-y-0.5",children:r.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-black",children:[i("EXTRA","EXTRA"),":"]})," ",e]},`${e}_${t}`))}):null]})}},4304:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>l});var a=s(8570);let r=(0,a.createProxy)(String.raw`/Users/rohitchandnani/tasting-pos/app/room/page.tsx`),{__esModule:n,$$typeof:i}=r;r.default;let l=(0,a.createProxy)(String.raw`/Users/rohitchandnani/tasting-pos/app/room/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,982,621,724,857],()=>s(7783));module.exports=a})();